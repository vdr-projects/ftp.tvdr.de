diff -ruN vdr-1.7.26/CONTRIBUTORS vdr-1.7.27/CONTRIBUTORS
--- vdr-1.7.26/CONTRIBUTORS	2012-03-03 15:06:06.000000000 +0100
+++ vdr-1.7.27/CONTRIBUTORS	2012-03-25 12:44:04.000000000 +0200
@@ -1137,6 +1137,9 @@
  for adding some typecasts to silence gcc compiler warnings
  for reporting a bug in handling OSD color button texts in case a menu item has
  texts of its own
+ for suggesting to change the Green button in the "Edit timer" menu from "Once"
+ to "Single"
+ for fixing reduced bpp support for DVB subtitles
 
 Ralf Klueber <ralf.klueber@vodafone.com>
  for reporting a bug in cutting a recording if there is only a single editing mark
@@ -1320,7 +1323,7 @@
  is a replay session active
 
 Peter Waechtler <pwaechtler@mac.com>
- for adding channels for DVB-T Hannover (Germany) to channels.cont.terr
+ for adding channels for DVB-T Hannover (Germany) to channels.conf.terr
 
 Robert Bartl <robert@bartl.priv.at>
  for reporting a hangup in SVDRP when the client disappears without sending QUIT
@@ -1852,7 +1855,7 @@
  through the full featured DVB card
 
 Walter Koch <koch@u32.de>
- for adding channels for DVB-T Düsseldorf and Köln (Germany) to channels.cont.terr
+ for adding channels for DVB-T Düsseldorf and Köln (Germany) to channels.conf.terr
  for fixing some missing '-' in the German OSD texts
  for suggesting to display the free disk space also in the title of the "Recordings"
  menu
@@ -1953,6 +1956,7 @@
  for removing a redundant NULL check in cDvbSpuDecoder::setTime()
  for pointing out that the variable HasSnr was unused in cDvbTuner::GetSignalQuality()
  for fixing cConfig::Load() for g++ version 4.7.0
+ for fixing some typos in HISTORY and CONTRIBUTORS
 
 Steffen Beyer <cpunk@reactor.de>
  for fixing setting the colored button help after deleting a recording in case the next
@@ -2326,6 +2330,8 @@
  for a patch that added a workaround for the broken linux-dvb driver header files
  for reporting a faulty "frame duration" instead of "frame rate" in vdr.5
  for avoiding a gcc 4.6 compiler error in the skincurses plugin.
+ for suggesting to move setting LC_NUMERIC further up to make sure any floating point
+ numbers use a decimal point
 
 Helge Lenz <h.lenz@gmx.de>
  for reporting a bug in setting the 'Delta' parameter when calling the shutdown
@@ -2383,6 +2389,7 @@
  for setting the audio type of language descriptors to 0x00 in the PAT/PMT generator
  for adding support for automatically selecting subtitles when playing old PES
  recordings made with the subtitles plugin
+ for pointing out -Werror=...
 
 Antti Hartikainen <ami+vdr@ah.fi>
  for updating 'S13E' in 'sources.conf'
@@ -2410,6 +2417,7 @@
  for fixing the German translation of "Folder name must not contain '%c'!"
  for suggestions used in revising priority handling to allow receivers with a priority
  that is lower than that of live viewing
+ for fixing handling IDLEPRIORITY in cDvbDevice::ProvidesChannel()
 
 Jörn Reder <joern@zyn.de>
  for reporting that a recording may unnecessarily block a device with a CAM, while
@@ -2833,6 +2841,8 @@
 Dominic Evans <oldmanuk@gmail.com>
  for making the SVDRP command LSTC accepts channel IDs
  for adding cap_net_raw to the capabilities that are not dropped
+ for suggesting to make the channel name column in the "What's on now/next" menu
+ adjust its width to display the full short name of each channel
 
 Torsten Lang <info@torstenlang.de>
  for reporting a problem with newline characters in stream component descriptions
diff -ruN vdr-1.7.26/HISTORY vdr-1.7.27/HISTORY
--- vdr-1.7.26/HISTORY	2012-03-10 15:28:06.000000000 +0100
+++ vdr-1.7.27/HISTORY	2012-03-25 12:43:46.000000000 +0200
@@ -2335,7 +2335,7 @@
 - Now explicitly handling exit value 0 and 2 in 'runvdr'.
 - Added a missing 'w' to the allowed characters for Finnish and Swedish (thanks
   to Lauri Tischler and Ragnar Sundblad).
-- Added channels for DVB-T Hannover (Germany) to channels.cont.terr (thanks to
+- Added channels for DVB-T Hannover (Germany) to channels.conf.terr (thanks to
   Peter Waechtler).
 - Fixed a hangup in SVDRP when the client disappears without sending QUIT (thanks
   to Robert Bartl for reporting this one). The problem was introduced in version
@@ -7009,3 +7009,45 @@
   + The default table id for a newly created cEvent has been changed to 0xFF,
     which is higher than any normal table id that is broadcast in the EIT data.
   See PLUGINS.html, section "Electronic Program Guide" for more information.
+
+2012-03-25: Version 1.7.27
+
+- Updated the Finnish OSD texts (thanks to Rolf Ahrenberg).
+- Changed the Green button in the "Edit timer" menu from "Once" to "Single"
+  (suggested by Rolf Ahrenberg).
+- Fixed some typos in HISTORY and CONTRIBUTORS (thanks to Ville Skyttä).
+- The channel name column in the "What's on now/next" menu now adjusts its width
+  to display the full short name of each channel (suggested by Dominic Evans).
+- Dropped the meanwhile obsolete script 'i18n-to-gettext'.
+- Removed the obsolete function cPlugin::RegisterI18n().
+- Removed the obsolete typedef tI18nPhrase.
+- Adapted menu column widths of 'skincurses' to the wider HD OSD sizes.
+- Deactivated definition of __RECORDING_H_DEPRECATED_DIRECT_MEMBER_ACCESS (recording.h)
+  and LEGACY_CRECEIVER (receiver.h) to trigger an error for any plugin that still
+  uses the respective code. You can reactivate these to quickly make your plugin
+  compile again, but beware that these code parts will be removed in one of the next
+  versions.
+- Made the "overloaded-virtual" warning an error to detect hidden overloaded
+  virtual functions (thanks to Anssi Hannula for pointing out -Werror=...).
+  Plugin authors may want to change -Woverloaded-virtual to -Werror=overloaded-virtual
+  in their Makefiles.
+- Updated the Estonian OSD texts (thanks to Arthur Konovalov).
+- Improved fast forwarding to the end of a timeshift recording.
+- The new function cDevice::DeviceName() returns a string identifying the name of
+  the given device.
+- When toggling a timer between "Single" and "Repeating", the previous setting is now
+  retained in case the user toggles back to the original value.
+- When estimating the remaining disk space (in hours), the average data rate of all
+  existing recordings is now taken into account. If this value can't be determined,
+  the previous value of 25.75 MB/min is taken.
+- No longer using GetFont() (which is not thread safe) in the 'osddemo' plugin.
+- No longer using GetFont() (which is not thread safe) in cSubtitleRegion::UpdateTextData().
+- Fixed a memory leak in cSubtitleRegion::UpdateTextData().
+- Moved setting LC_NUMERIC further up to make sure any floating point numbers use a
+  decimal point (suggested by Tobias Grimm).
+- Added missing channel locking to cEIT.
+- Fixed reduced bpp support for DVB subtitles (thanks to Rolf Ahrenberg).
+- Updated the Italian OSD texts (thanks to Diego Pierotto).
+- Reverted some improvements to Make.config.template (thanks to Christian Ruppert).
+- Fixed handling IDLEPRIORITY in cDvbDevice::ProvidesChannel() (thanks to Frank
+  Schmirler).
diff -ruN vdr-1.7.26/Make.config.template vdr-1.7.27/Make.config.template
--- vdr-1.7.26/Make.config.template	2012-02-27 11:56:28.000000000 +0100
+++ vdr-1.7.27/Make.config.template	2012-03-20 12:20:13.000000000 +0100
@@ -6,15 +6,15 @@
 # See the main source file 'vdr.c' for copyright information and
 # how to reach the author.
 #
-# $Id: Make.config.template 2.6 2012/02/27 10:56:28 kls Exp $
+# $Id: Make.config.template 2.8 2012/03/20 11:20:13 kls Exp $
 
 ### The C compiler and options:
 
-CC       ?= gcc
-CFLAGS   ?= -g -O3 -Wall
+CC       = gcc
+CFLAGS   = -g -O3 -Wall
 
-CXX      ?= g++
-CXXFLAGS ?= -g -O3 -Wall -Woverloaded-virtual -Wno-parentheses
+CXX      = g++
+CXXFLAGS = -g -O3 -Wall -Werror=overloaded-virtual -Wno-parentheses
 
 ifdef PLUGIN
 CFLAGS   += -fPIC
@@ -23,23 +23,23 @@
 
 ### The directory environment:
 
-PREFIX   ?= $(DESTDIR)/usr/local
-#DVBDIR   ?= /usr/src/v4l-dvb/linux
-MANDIR   ?= $(PREFIX)/man
-BINDIR   ?= $(PREFIX)/bin
-
-LOCDIR       ?= ./locale
-PLUGINDIR    ?= ./PLUGINS
-PLUGINLIBDIR ?= $(PLUGINDIR)/lib
-VIDEODIR     ?= /video
-CONFDIR      ?= $(VIDEODIR)
+PREFIX   = $(DESTDIR)/usr/local
+#DVBDIR   = /usr/src/v4l-dvb/linux
+MANDIR   = $(PREFIX)/man
+BINDIR   = $(PREFIX)/bin
+
+LOCDIR       = ./locale
+PLUGINDIR    = ./PLUGINS
+PLUGINLIBDIR = $(PLUGINDIR)/lib
+VIDEODIR     = /video
+CONFDIR      = $(VIDEODIR)
 
 ### The remote control:
 
-LIRC_DEVICE ?= /var/run/lirc/lircd
+LIRC_DEVICE = /var/run/lirc/lircd
 
 ## Define if you want vdr to not run as root
-#VDR_USER ?= vdr
+#VDR_USER = vdr
 
 ### You don't need to touch the following:
 
diff -ruN vdr-1.7.26/Makefile vdr-1.7.27/Makefile
--- vdr-1.7.26/Makefile	2012-02-27 11:54:38.000000000 +0100
+++ vdr-1.7.27/Makefile	2012-03-11 16:33:57.000000000 +0100
@@ -4,7 +4,7 @@
 # See the main source file 'vdr.c' for copyright information and
 # how to reach the author.
 #
-# $Id: Makefile 2.25 2012/02/27 10:54:38 kls Exp $
+# $Id: Makefile 2.26 2012/03/11 15:33:57 kls Exp $
 
 .DELETE_ON_ERROR:
 
@@ -12,7 +12,7 @@
 CFLAGS   ?= -g -O3 -Wall
 
 CXX      ?= g++
-CXXFLAGS ?= -g -O3 -Wall -Woverloaded-virtual -Wno-parentheses
+CXXFLAGS ?= -g -O3 -Wall -Werror=overloaded-virtual -Wno-parentheses
 
 LSIDIR   = ./libsi
 DESTDIR ?=
diff -ruN vdr-1.7.26/PLUGINS/src/dvbhddevice/Makefile vdr-1.7.27/PLUGINS/src/dvbhddevice/Makefile
--- vdr-1.7.26/PLUGINS/src/dvbhddevice/Makefile	2012-02-08 16:10:09.000000000 +0100
+++ vdr-1.7.27/PLUGINS/src/dvbhddevice/Makefile	2012-03-11 16:34:00.000000000 +0100
@@ -1,7 +1,7 @@
 #
 # Makefile for a Video Disk Recorder plugin
 #
-# $Id: Makefile 1.12 2012/02/08 15:10:09 kls Exp $
+# $Id: Makefile 1.13 2012/03/11 15:34:00 kls Exp $
 
 # The official name of this plugin.
 # This name will be used in the '-P...' option of VDR to load the plugin.
@@ -18,7 +18,7 @@
 ### The C++ compiler and options:
 
 CXX      ?= g++
-CXXFLAGS ?= -g -O3 -Wall -Woverloaded-virtual -Wno-parentheses
+CXXFLAGS ?= -g -O3 -Wall -Werror=overloaded-virtual -Wno-parentheses
 
 ### The directory environment:
 
diff -ruN vdr-1.7.26/PLUGINS/src/dvbhddevice/po/fi_FI.po vdr-1.7.27/PLUGINS/src/dvbhddevice/po/fi_FI.po
--- vdr-1.7.26/PLUGINS/src/dvbhddevice/po/fi_FI.po	2012-02-08 16:15:13.000000000 +0100
+++ vdr-1.7.27/PLUGINS/src/dvbhddevice/po/fi_FI.po	2012-03-18 16:30:03.000000000 +0100
@@ -44,7 +44,7 @@
 msgstr "aina 16:9"
 
 msgid "Zoom 16/9"
-msgstr ""
+msgstr "zoom 16/9"
 
 msgid "Off"
 msgstr "ei"
@@ -98,10 +98,10 @@
 msgstr "KÃ¤ytÃ¤ HDMI CEC-toimintoa"
 
 msgid "CEC: Switch TV on"
-msgstr ""
+msgstr "CEC: Laita TV pÃ¤Ã¤lle"
 
 msgid "CEC: Switch TV off"
-msgstr ""
+msgstr "CEC: Sammuta TV"
 
 msgid "Remote Control Protocol"
 msgstr "KaukosÃ¤Ã¤timen protokolla"
@@ -116,4 +116,4 @@
 msgstr "Salli tosivÃ¤rit kuvaruutunÃ¤ytÃ¶lle"
 
 msgid "Hide mainmenu entry"
-msgstr ""
+msgstr "Piilota valinta pÃ¤Ã¤valikosta"
diff -ruN vdr-1.7.26/PLUGINS/src/dvbsddevice/Makefile vdr-1.7.27/PLUGINS/src/dvbsddevice/Makefile
--- vdr-1.7.26/PLUGINS/src/dvbsddevice/Makefile	2012-01-18 13:28:43.000000000 +0100
+++ vdr-1.7.27/PLUGINS/src/dvbsddevice/Makefile	2012-03-11 16:34:02.000000000 +0100
@@ -1,7 +1,7 @@
 #
 # Makefile for a Video Disk Recorder plugin
 #
-# $Id: Makefile 1.8 2012/01/18 12:28:43 kls Exp $
+# $Id: Makefile 1.9 2012/03/11 15:34:02 kls Exp $
 
 # The official name of this plugin.
 # This name will be used in the '-P...' option of VDR to load the plugin.
@@ -18,7 +18,7 @@
 ### The C++ compiler and options:
 
 CXX      ?= g++
-CXXFLAGS ?= -g -O3 -Wall -Woverloaded-virtual -Wno-parentheses
+CXXFLAGS ?= -g -O3 -Wall -Werror=overloaded-virtual -Wno-parentheses
 
 ### The directory environment:
 
diff -ruN vdr-1.7.26/PLUGINS/src/dvbsddevice/dvbsdffdevice.c vdr-1.7.27/PLUGINS/src/dvbsddevice/dvbsdffdevice.c
--- vdr-1.7.26/PLUGINS/src/dvbsddevice/dvbsdffdevice.c	2012-03-07 14:52:48.000000000 +0100
+++ vdr-1.7.27/PLUGINS/src/dvbsddevice/dvbsdffdevice.c	2012-03-11 14:32:42.000000000 +0100
@@ -3,7 +3,7 @@
  *
  * See the README file for copyright information and how to reach the author.
  *
- * $Id: dvbsdffdevice.c 2.32 2012/03/07 13:52:48 kls Exp $
+ * $Id: dvbsdffdevice.c 2.33 2012/03/11 13:32:42 kls Exp $
  */
 
 #include "dvbsdffdevice.h"
@@ -431,7 +431,7 @@
         }
      if (IsPrimaryDevice())
         AddPid(Channel->Tpid(), ptTeletext);
-     CHECK(ioctl(fd_audio, AUDIO_SET_MUTE, true)); // actually one would expect 'false' here, but according to Marco Schlüßler <marco@lordzodiac.de> this works
+     CHECK(ioctl(fd_audio, AUDIO_SET_MUTE, true)); // actually one would expect 'false' here, but according to Marco Schluessler <marco@lordzodiac.de> this works
                                                    // to avoid missing audio after replaying a DVD; with 'false' there is an audio disturbance when switching
                                                    // between two channels on the same transponder on DVB-S
      CHECK(ioctl(fd_audio, AUDIO_SET_AV_SYNC, true));
diff -ruN vdr-1.7.26/PLUGINS/src/epgtableid0/Makefile vdr-1.7.27/PLUGINS/src/epgtableid0/Makefile
--- vdr-1.7.26/PLUGINS/src/epgtableid0/Makefile	2012-03-10 15:23:58.000000000 +0100
+++ vdr-1.7.27/PLUGINS/src/epgtableid0/Makefile	2012-03-11 16:34:04.000000000 +0100
@@ -1,7 +1,7 @@
 #
 # Makefile for a Video Disk Recorder plugin
 #
-# $Id: Makefile 1.1 2012/03/10 14:23:58 kls Exp $
+# $Id: Makefile 1.2 2012/03/11 15:34:04 kls Exp $
 
 # The official name of this plugin.
 # This name will be used in the '-P...' option of VDR to load the plugin.
@@ -18,7 +18,7 @@
 ### The C++ compiler and options:
 
 CXX      ?= g++
-CXXFLAGS ?= -g -O3 -Wall -Woverloaded-virtual -Wno-parentheses
+CXXFLAGS ?= -g -O3 -Wall -Werror=overloaded-virtual -Wno-parentheses
 
 ### The directory environment:
 
diff -ruN vdr-1.7.26/PLUGINS/src/hello/Makefile vdr-1.7.27/PLUGINS/src/hello/Makefile
--- vdr-1.7.26/PLUGINS/src/hello/Makefile	2012-01-18 13:29:09.000000000 +0100
+++ vdr-1.7.27/PLUGINS/src/hello/Makefile	2012-03-11 16:34:06.000000000 +0100
@@ -1,7 +1,7 @@
 #
 # Makefile for a Video Disk Recorder plugin
 #
-# $Id: Makefile 2.8 2012/01/18 12:29:09 kls Exp $
+# $Id: Makefile 2.9 2012/03/11 15:34:06 kls Exp $
 
 # The official name of this plugin.
 # This name will be used in the '-P...' option of VDR to load the plugin.
@@ -18,7 +18,7 @@
 ### The C++ compiler and options:
 
 CXX      ?= g++
-CXXFLAGS ?= -g -O3 -Wall -Woverloaded-virtual -Wno-parentheses
+CXXFLAGS ?= -g -O3 -Wall -Werror=overloaded-virtual -Wno-parentheses
 
 ### The directory environment:
 
diff -ruN vdr-1.7.26/PLUGINS/src/osddemo/HISTORY vdr-1.7.27/PLUGINS/src/osddemo/HISTORY
--- vdr-1.7.26/PLUGINS/src/osddemo/HISTORY	2011-04-17 15:05:01.000000000 +0200
+++ vdr-1.7.27/PLUGINS/src/osddemo/HISTORY	2012-03-13 16:18:15.000000000 +0100
@@ -34,3 +34,7 @@
 2011-04-17: Version 0.2.2
 
 - Fixed a possible NULL pointer dereference in osddemo.c (reported by Paul Menzel).
+
+2012-03-13: Version 0.2.3
+
+- No longer using GetFont() (which is not thread safe) in the 'osddemo' plugin,
diff -ruN vdr-1.7.26/PLUGINS/src/osddemo/Makefile vdr-1.7.27/PLUGINS/src/osddemo/Makefile
--- vdr-1.7.26/PLUGINS/src/osddemo/Makefile	2012-01-18 13:17:23.000000000 +0100
+++ vdr-1.7.27/PLUGINS/src/osddemo/Makefile	2012-03-11 16:34:08.000000000 +0100
@@ -1,7 +1,7 @@
 #
 # Makefile for a Video Disk Recorder plugin
 #
-# $Id: Makefile 2.4 2012/01/18 12:17:23 kls Exp $
+# $Id: Makefile 2.5 2012/03/11 15:34:08 kls Exp $
 
 # The official name of this plugin.
 # This name will be used in the '-P...' option of VDR to load the plugin.
@@ -16,7 +16,7 @@
 ### The C++ compiler and options:
 
 CXX      ?= g++
-CXXFLAGS ?= -g -O3 -Wall -Woverloaded-virtual -Wno-parentheses
+CXXFLAGS ?= -g -O3 -Wall -Werror=overloaded-virtual -Wno-parentheses
 
 ### The directory environment:
 
diff -ruN vdr-1.7.26/PLUGINS/src/osddemo/osddemo.c vdr-1.7.27/PLUGINS/src/osddemo/osddemo.c
--- vdr-1.7.26/PLUGINS/src/osddemo/osddemo.c	2011-04-17 15:05:13.000000000 +0200
+++ vdr-1.7.27/PLUGINS/src/osddemo/osddemo.c	2012-03-13 16:17:33.000000000 +0100
@@ -3,13 +3,13 @@
  *
  * See the README file for copyright information and how to reach the author.
  *
- * $Id: osddemo.c 2.5 2011/04/17 13:05:13 kls Exp $
+ * $Id: osddemo.c 2.6 2012/03/13 15:17:33 kls Exp $
  */
 
 #include <vdr/osd.h>
 #include <vdr/plugin.h>
 
-static const char *VERSION        = "0.2.2";
+static const char *VERSION        = "0.2.3";
 static const char *DESCRIPTION    = "Demo of arbitrary OSD setup";
 static const char *MAINMENUENTRY  = "Osd Demo";
 
@@ -85,7 +85,7 @@
   cPixmap *destroyablePixmap;
   cPixmap *toggleablePixmap;
   virtual void Action(void);
-  cPixmap *CreateTextPixmap(const char *s, int Line, int Layer, tColor ColorFg, tColor ColorBg, const cFont *Font = NULL);
+  cPixmap *CreateTextPixmap(const char *s, int Line, int Layer, tColor ColorFg, tColor ColorBg, const cFont *Font);
 public:
   cTrueColorDemo(void);
   virtual ~cTrueColorDemo();
@@ -109,8 +109,6 @@
 
 cPixmap *cTrueColorDemo::CreateTextPixmap(const char *s, int Line, int Layer, tColor ColorFg, tColor ColorBg, const cFont *Font)
 {
-  if (!Font)
-     Font = cFont::GetFont(fontOsd);
   const int h = Font->Height(s);
   int w = Font->Width(s);
   cPixmap *Pixmap = osd->CreatePixmap(Layer, cRect((osd->Width() - w) / 2, Line, w, h));
@@ -131,6 +129,9 @@
   cPixmap *TilePixmap = NULL;
   cPixmap *ScrollPixmap = NULL;
   cPixmap *AnimPixmap = NULL;
+  cFont *OsdFont = cFont::CreateFont(Setup.FontOsd, Setup.FontOsdSize);
+  cFont *SmlFont = cFont::CreateFont(Setup.FontSml, Setup.FontSmlSize);
+  cFont *LrgFont = cFont::CreateFont(Setup.FontOsd, osd->Height() / 10);
   int FrameTime = 40; // ms
   int FadeTime = 1000; // ms
   int MoveTime = 4000; // ms
@@ -202,10 +203,9 @@
                        cRect r = ScrollPixmap->DrawPort();
                        r.SetPoint(-r.X(), -r.Y());
                        ScrollPixmap->Pan(cPoint(0, 0), r);
-                       const cFont *Font = cFont::GetFont(fontOsd);
                        cString s = cString::sprintf("Line %d", ++ScrollLineNumber);
                        ScrollPixmap->DrawRectangle(cRect(0, ScrollPixmap->ViewPort().Height(), ScrollPixmap->DrawPort().Width(), ScrollPixmap->DrawPort().Height()), clrTransparent);
-                       ScrollPixmap->DrawText(cPoint(0, ScrollPixmap->ViewPort().Height()), s, clrYellow, clrTransparent, Font);
+                       ScrollPixmap->DrawText(cPoint(0, ScrollPixmap->ViewPort().Height()), s, clrYellow, clrTransparent, OsdFont);
                        ScrollStartTime = Now;
                        }
                     else {
@@ -234,18 +234,15 @@
         if (!Animated) {
            switch (State) {
              case 0: {
-                       if (cFont *Font = cFont::CreateFont(DefaultFontOsd, osd->Height() / 10)) {
-                          FadeInPixmap = CreateTextPixmap("VDR", Line, 1, clrYellow, clrTransparent, Font);
-                          if (FadeInPixmap)
-                             Line += FadeInPixmap->DrawPort().Height();
-                          delete Font;
-                          Start = cTimeMs::Now();
-                          }
+                       FadeInPixmap = CreateTextPixmap("VDR", Line, 1, clrYellow, clrTransparent, LrgFont);
+                       if (FadeInPixmap)
+                          Line += FadeInPixmap->DrawPort().Height();
+                       Start = cTimeMs::Now();
                        State++;
                      }
                      break;
              case 1: { 
-                       FadeInPixmap = CreateTextPixmap("Video Disk Recorder", Line, 3, clrYellow, clrTransparent);
+                       FadeInPixmap = CreateTextPixmap("Video Disk Recorder", Line, 3, clrYellow, clrTransparent, OsdFont);
                        if (FadeInPixmap)
                           Line += FadeInPixmap->DrawPort().Height();
                        Start = cTimeMs::Now();
@@ -253,7 +250,7 @@
                      }
                      break;
              case 2: {
-                       FadeInPixmap = CreateTextPixmap("True Color OSD Demo", Line, 1, clrYellow, clrTransparent);
+                       FadeInPixmap = CreateTextPixmap("True Color OSD Demo", Line, 1, clrYellow, clrTransparent, OsdFont);
                        if (FadeInPixmap)
                           Line += FadeInPixmap->DrawPort().Height();
                        Start = cTimeMs::Now();
@@ -261,15 +258,12 @@
                      }
                      break;
              case 3: {
-                       if (cFont *Font = cFont::CreateFont(DefaultFontOsd, osd->Height() / 10)) {
-                          NextPixmap = CreateTextPixmap("Millions of colors", Line, 1, clrYellow, clrTransparent, Font);
-                          delete Font;
-                          if (NextPixmap) {
-                             FadeInPixmap = NextPixmap;
-                             Start = cTimeMs::Now();
-                             StartLine = Line;
-                             Line += NextPixmap->DrawPort().Height();
-                             }
+                       NextPixmap = CreateTextPixmap("Millions of colors", Line, 1, clrYellow, clrTransparent, LrgFont);
+                       if (NextPixmap) {
+                          FadeInPixmap = NextPixmap;
+                          Start = cTimeMs::Now();
+                          StartLine = Line;
+                          Line += NextPixmap->DrawPort().Height();
                           }
                        State++;
                      }
@@ -301,7 +295,7 @@
                      }
                      break;
              case 6: {
-                       TilePixmap = CreateTextPixmap("Tiled Pixmaps", StartLine, 1, clrRed, clrWhite);
+                       TilePixmap = CreateTextPixmap("Tiled Pixmaps", StartLine, 1, clrRed, clrWhite, OsdFont);
                        if (TilePixmap) {
                           TilePixmap->SetViewPort(TilePixmap->ViewPort().Grown(TilePixmap->DrawPort().Width(), TilePixmap->DrawPort().Height()));
                           TilePixmap->SetAlpha(200);
@@ -317,15 +311,14 @@
                      }
                      break;
              case 7: {
-                       const cFont *Font = cFont::GetFont(fontOsd);
                        const char *Text = "Scrolling Pixmaps";
-                       int w = Font->Width(Text);
-                       int h = Font->Height();
+                       int w = OsdFont->Width(Text);
+                       int h = OsdFont->Height();
                        if (cPixmap *Pixmap = osd->CreatePixmap(2, cRect((osd->Width() - w) / 2, StartLine, w, 2 * h), cRect(0, 0, w, 3 * h))) {
                           Pixmap->Clear();
-                          Pixmap->DrawText(cPoint(0, 0), Text, clrYellow, clrTransparent, Font);
+                          Pixmap->DrawText(cPoint(0, 0), Text, clrYellow, clrTransparent, OsdFont);
                           cString s = cString::sprintf("Line %d", ++ScrollLineNumber);
-                          Pixmap->DrawText(cPoint(0, Pixmap->ViewPort().Height()), s, clrYellow, clrTransparent, Font);
+                          Pixmap->DrawText(cPoint(0, Pixmap->ViewPort().Height()), s, clrYellow, clrTransparent, OsdFont);
                           ScrollPixmap = Pixmap;
                           ScrollStart.Set(0, 0);
                           ScrollEnd.Set(0, -h);
@@ -335,9 +328,8 @@
                      }
                      break;
              case 8: {
-                       const cFont *Font = cFont::GetFont(fontSml);
                        const char *Text = "Animation";
-                       const int Size = Font->Width(Text) + 10;
+                       const int Size = SmlFont->Width(Text) + 10;
                        const int NumDots = 12;
                        const int AnimFrames = NumDots;
                        // Temporarily using pixmap layer 0 to have the text alpha blended:
@@ -359,7 +351,7 @@
                                   AnimPixmap->DrawEllipse(cRect(x, y, Diameter, Diameter), ArgbToColor(0xFF, Color, Color, Color));
                                   Color -= Delta;
                                   }
-                              AnimPixmap->DrawText(cPoint(0, Frame * Size), Text, clrBlack, clrTransparent, cFont::GetFont(fontSml), Size, Size, taCenter);
+                              AnimPixmap->DrawText(cPoint(0, Frame * Size), Text, clrBlack, clrTransparent, SmlFont, Size, Size, taCenter);
                               }
                           AnimPixmap->SetLayer(3); // now setting the actual pixmap layer
                           FadeInPixmap = AnimPixmap;
@@ -393,6 +385,9 @@
         if (Delta < FrameTime)
            cCondWait::SleepMs(FrameTime - Delta);
         }
+  delete OsdFont;
+  delete SmlFont;
+  delete LrgFont;
 }
 
 void cTrueColorDemo::Show(void)
diff -ruN vdr-1.7.26/PLUGINS/src/pictures/Makefile vdr-1.7.27/PLUGINS/src/pictures/Makefile
--- vdr-1.7.26/PLUGINS/src/pictures/Makefile	2012-01-18 13:30:05.000000000 +0100
+++ vdr-1.7.27/PLUGINS/src/pictures/Makefile	2012-03-11 16:34:10.000000000 +0100
@@ -1,7 +1,7 @@
 #
 # Makefile for a Video Disk Recorder plugin
 #
-# $Id: Makefile 2.8 2012/01/18 12:30:05 kls Exp $
+# $Id: Makefile 2.9 2012/03/11 15:34:10 kls Exp $
 
 # The official name of this plugin.
 # This name will be used in the '-P...' option of VDR to load the plugin.
@@ -18,7 +18,7 @@
 ### The C++ compiler and options:
 
 CXX      ?= g++
-CXXFLAGS ?= -g -O3 -Wall -Woverloaded-virtual -Wno-parentheses
+CXXFLAGS ?= -g -O3 -Wall -Werror=overloaded-virtual -Wno-parentheses
 
 ### The directory environment:
 
diff -ruN vdr-1.7.26/PLUGINS/src/rcu/Makefile vdr-1.7.27/PLUGINS/src/rcu/Makefile
--- vdr-1.7.26/PLUGINS/src/rcu/Makefile	2012-02-27 11:46:08.000000000 +0100
+++ vdr-1.7.27/PLUGINS/src/rcu/Makefile	2012-03-11 16:34:12.000000000 +0100
@@ -1,7 +1,7 @@
 #
 # Makefile for a Video Disk Recorder plugin
 #
-# $Id: Makefile 1.1 2012/02/27 10:46:08 kls Exp $
+# $Id: Makefile 1.2 2012/03/11 15:34:12 kls Exp $
 
 # The official name of this plugin.
 # This name will be used in the '-P...' option of VDR to load the plugin.
@@ -18,7 +18,7 @@
 ### The C++ compiler and options:
 
 CXX      ?= g++
-CXXFLAGS ?= -g -O3 -Wall -Woverloaded-virtual -Wno-parentheses
+CXXFLAGS ?= -g -O3 -Wall -Werror=overloaded-virtual -Wno-parentheses
 
 ### The directory environment:
 
diff -ruN vdr-1.7.26/PLUGINS/src/servicedemo/Makefile vdr-1.7.27/PLUGINS/src/servicedemo/Makefile
--- vdr-1.7.26/PLUGINS/src/servicedemo/Makefile	2012-01-18 13:17:23.000000000 +0100
+++ vdr-1.7.27/PLUGINS/src/servicedemo/Makefile	2012-03-11 16:34:13.000000000 +0100
@@ -1,7 +1,7 @@
 #
 # Makefile for a Video Disk Recorder plugin
 #
-# $Id: Makefile 2.4 2012/01/18 12:17:23 kls Exp $
+# $Id: Makefile 2.5 2012/03/11 15:34:13 kls Exp $
 
 # The official name of this plugin.
 # This name will be used in the '-P...' option of VDR to load the plugin.
@@ -18,7 +18,7 @@
 ### The C++ compiler and options:
 
 CXX      ?= g++
-CXXFLAGS ?= -g -O3 -Wall -Woverloaded-virtual -Wno-parentheses
+CXXFLAGS ?= -g -O3 -Wall -Werror=overloaded-virtual -Wno-parentheses
 
 ### The directory environment:
 
diff -ruN vdr-1.7.26/PLUGINS/src/skincurses/HISTORY vdr-1.7.27/PLUGINS/src/skincurses/HISTORY
--- vdr-1.7.26/PLUGINS/src/skincurses/HISTORY	2011-05-15 23:43:11.000000000 +0200
+++ vdr-1.7.27/PLUGINS/src/skincurses/HISTORY	2012-03-11 15:44:17.000000000 +0100
@@ -92,3 +92,7 @@
 2011-05-15: Version 0.1.10
 
 - Avoiding a gcc 4.6 compiler error (thanks to Tobias Grimm).
+
+2012-03-11: Version 0.1.11
+
+- Adapted menu column widths of 'skincurses' to the wider HD OSD sizes.
diff -ruN vdr-1.7.26/PLUGINS/src/skincurses/Makefile vdr-1.7.27/PLUGINS/src/skincurses/Makefile
--- vdr-1.7.26/PLUGINS/src/skincurses/Makefile	2012-01-18 13:30:52.000000000 +0100
+++ vdr-1.7.27/PLUGINS/src/skincurses/Makefile	2012-03-11 16:34:18.000000000 +0100
@@ -1,7 +1,7 @@
 #
 # Makefile for a Video Disk Recorder plugin
 #
-# $Id: Makefile 2.8 2012/01/18 12:30:52 kls Exp $
+# $Id: Makefile 2.9 2012/03/11 15:34:18 kls Exp $
 
 # The official name of this plugin.
 # This name will be used in the '-P...' option of VDR to load the plugin.
@@ -18,7 +18,7 @@
 ### The C++ compiler and options:
 
 CXX      ?= g++
-CXXFLAGS ?= -g -O3 -Wall -Woverloaded-virtual -Wno-parentheses
+CXXFLAGS ?= -g -O3 -Wall -Werror=overloaded-virtual -Wno-parentheses
 
 ### The directory environment:
 
diff -ruN vdr-1.7.26/PLUGINS/src/skincurses/skincurses.c vdr-1.7.27/PLUGINS/src/skincurses/skincurses.c
--- vdr-1.7.26/PLUGINS/src/skincurses/skincurses.c	2011-08-21 13:04:38.000000000 +0200
+++ vdr-1.7.27/PLUGINS/src/skincurses/skincurses.c	2012-03-11 15:42:52.000000000 +0100
@@ -3,7 +3,7 @@
  *
  * See the README file for copyright information and how to reach the author.
  *
- * $Id: skincurses.c 2.7 2011/08/21 11:04:38 kls Exp $
+ * $Id: skincurses.c 2.8 2012/03/11 14:42:52 kls Exp $
  */
 
 #include <ncurses.h>
@@ -11,7 +11,7 @@
 #include <vdr/plugin.h>
 #include <vdr/skins.h>
 
-static const char *VERSION        = "0.1.10";
+static const char *VERSION        = "0.1.11";
 static const char *DESCRIPTION    = trNOOP("A text only skin");
 static const char *MAINMENUENTRY  = NULL;
 
@@ -375,13 +375,13 @@
   for (int i = 0; i < MaxTabs; i++) {
       const char *s = GetTabbedText(Text, i);
       if (s) {
-         int xt = Tab(i) / 12;// Tab() is in "pixel" - see also skins.c!!!
+         int xt = Tab(i) / AvgCharWidth();// Tab() is in "pixel" - see also skins.c!!!
          osd->DrawText(xt, y, s, ColorFg, ColorBg, &Font, ScOsdWidth - 2 - xt);
          }
       if (!Tab(i + 1))
          break;
       }
-  SetEditableWidth(ScOsdWidth - 2 - Tab(1) / 12); // Tab() is in "pixel" - see also skins.c!!!
+  SetEditableWidth(ScOsdWidth - 2 - Tab(1) / AvgCharWidth()); // Tab() is in "pixel" - see also skins.c!!!
 }
 
 void cSkinCursesDisplayMenu::SetScrollbar(int Total, int Offset)
diff -ruN vdr-1.7.26/PLUGINS/src/status/HISTORY vdr-1.7.27/PLUGINS/src/status/HISTORY
--- vdr-1.7.26/PLUGINS/src/status/HISTORY	2008-02-16 15:27:58.000000000 +0100
+++ vdr-1.7.27/PLUGINS/src/status/HISTORY	2012-03-11 15:50:04.000000000 +0100
@@ -44,3 +44,7 @@
 2008-02-16: Version 0.3.0
 
 - Added new cStatus functions.
+
+2012-03-11: Version 0.3.1
+
+- Added new parameter LiveView to ChannelSwitch() (reported by Udo Richter).
diff -ruN vdr-1.7.26/PLUGINS/src/status/Makefile vdr-1.7.27/PLUGINS/src/status/Makefile
--- vdr-1.7.26/PLUGINS/src/status/Makefile	2012-01-18 13:17:23.000000000 +0100
+++ vdr-1.7.27/PLUGINS/src/status/Makefile	2012-03-11 16:34:20.000000000 +0100
@@ -1,7 +1,7 @@
 #
 # Makefile for a Video Disk Recorder plugin
 #
-# $Id: Makefile 2.4 2012/01/18 12:17:23 kls Exp $
+# $Id: Makefile 2.5 2012/03/11 15:34:20 kls Exp $
 
 # The official name of this plugin.
 # This name will be used in the '-P...' option of VDR to load the plugin.
@@ -16,7 +16,7 @@
 ### The C++ compiler and options:
 
 CXX      ?= g++
-CXXFLAGS ?= -g -O3 -Wall -Woverloaded-virtual -Wno-parentheses
+CXXFLAGS ?= -g -O3 -Wall -Werror=overloaded-virtual -Wno-parentheses
 
 ### The directory environment:
 
diff -ruN vdr-1.7.26/PLUGINS/src/status/status.c vdr-1.7.27/PLUGINS/src/status/status.c
--- vdr-1.7.26/PLUGINS/src/status/status.c	2008-02-16 16:41:05.000000000 +0100
+++ vdr-1.7.27/PLUGINS/src/status/status.c	2012-03-11 15:48:37.000000000 +0100
@@ -3,13 +3,13 @@
  *
  * See the README file for copyright information and how to reach the author.
  *
- * $Id: status.c 2.0 2008/02/16 15:41:05 kls Exp $
+ * $Id: status.c 2.1 2012/03/11 14:48:37 kls Exp $
  */
 
 #include <vdr/plugin.h>
 #include <vdr/status.h>
 
-static const char *VERSION        = "0.3.0";
+static const char *VERSION        = "0.3.1";
 static const char *DESCRIPTION    = "Status monitor test";
 static const char *MAINMENUENTRY  = NULL;
 
@@ -18,7 +18,7 @@
 class cStatusTest : public cStatus {
 protected:
   virtual void TimerChange(const cTimer *Timer, eTimerChange Change);
-  virtual void ChannelSwitch(const cDevice *Device, int ChannelNumber);
+  virtual void ChannelSwitch(const cDevice *Device, int ChannelNumber, bool LiveView);
   virtual void Recording(const cDevice *Device, const char *Name, const char *FileName, bool On);
   virtual void Replaying(const cControl *Control, const char *Name, const char *FileName, bool On);
   virtual void SetVolume(int Volume, bool Absolute);
@@ -41,9 +41,9 @@
   dsyslog("status: cStatusTest::TimerChange  %s %d", Timer ? *Timer->ToText(true) : "-", Change);
 }
 
-void cStatusTest::ChannelSwitch(const cDevice *Device, int ChannelNumber)
+void cStatusTest::ChannelSwitch(const cDevice *Device, int ChannelNumber, bool LiveView)
 {
-  dsyslog("status: cStatusTest::ChannelSwitch  %d %d", Device->CardIndex(), ChannelNumber);
+  dsyslog("status: cStatusTest::ChannelSwitch  %d %d %d", Device->CardIndex(), ChannelNumber, LiveView);
 }
 
 void cStatusTest::Recording(const cDevice *Device, const char *Name, const char *FileName, bool On)
diff -ruN vdr-1.7.26/PLUGINS/src/svdrpdemo/Makefile vdr-1.7.27/PLUGINS/src/svdrpdemo/Makefile
--- vdr-1.7.26/PLUGINS/src/svdrpdemo/Makefile	2012-01-18 13:17:23.000000000 +0100
+++ vdr-1.7.27/PLUGINS/src/svdrpdemo/Makefile	2012-03-11 16:34:22.000000000 +0100
@@ -1,7 +1,7 @@
 #
 # Makefile for a Video Disk Recorder plugin
 #
-# $Id: Makefile 2.4 2012/01/18 12:17:23 kls Exp $
+# $Id: Makefile 2.5 2012/03/11 15:34:22 kls Exp $
 
 # The official name of this plugin.
 # This name will be used in the '-P...' option of VDR to load the plugin.
@@ -16,7 +16,7 @@
 ### The C++ compiler and options:
 
 CXX      ?= g++
-CXXFLAGS ?= -g -O3 -Wall -Woverloaded-virtual -Wno-parentheses
+CXXFLAGS ?= -g -O3 -Wall -Werror=overloaded-virtual -Wno-parentheses
 
 ### The directory environment:
 
diff -ruN vdr-1.7.26/channels.c vdr-1.7.27/channels.c
--- vdr-1.7.26/channels.c	2012-03-07 17:50:15.000000000 +0100
+++ vdr-1.7.27/channels.c	2012-03-11 14:29:06.000000000 +0100
@@ -4,7 +4,7 @@
  * See the main source file 'vdr.c' for copyright information and
  * how to reach the author.
  *
- * $Id: channels.c 2.20 2012/03/07 16:50:15 kls Exp $
+ * $Id: channels.c 2.21 2012/03/11 13:29:06 kls Exp $
  */
 
 #include "channels.h"
@@ -760,6 +760,8 @@
 cChannels::cChannels(void)
 {
   maxNumber = 0;
+  maxChannelNameLength = 0;
+  maxShortChannelNameLength = 0;
   modified = CHANNELSMOD_NONE;
 }
 
@@ -937,9 +939,32 @@
   return channel && cDevice::PrimaryDevice()->SwitchChannel(channel, true);
 }
 
+int cChannels::MaxChannelNameLength(void)
+{
+  if (!maxChannelNameLength) {
+     for (cChannel *channel = First(); channel; channel = Next(channel)) {
+         if (!channel->GroupSep())
+            maxChannelNameLength = max(Utf8StrLen(channel->Name()), maxChannelNameLength);
+         }
+     }
+  return maxChannelNameLength;
+}
+
+int cChannels::MaxShortChannelNameLength(void)
+{
+  if (!maxShortChannelNameLength) {
+     for (cChannel *channel = First(); channel; channel = Next(channel)) {
+         if (!channel->GroupSep())
+            maxShortChannelNameLength = max(Utf8StrLen(channel->ShortName()), maxShortChannelNameLength);
+         }
+     }
+  return maxShortChannelNameLength;
+}
+
 void cChannels::SetModified(bool ByUser)
 {
   modified = ByUser ? CHANNELSMOD_USER : !modified ? CHANNELSMOD_AUTO : modified;
+  maxChannelNameLength = maxShortChannelNameLength = 0;
 }
 
 int cChannels::Modified(void)
diff -ruN vdr-1.7.26/channels.h vdr-1.7.27/channels.h
--- vdr-1.7.26/channels.h	2011-08-06 11:56:13.000000000 +0200
+++ vdr-1.7.27/channels.h	2012-03-11 12:46:39.000000000 +0100
@@ -4,7 +4,7 @@
  * See the main source file 'vdr.c' for copyright information and
  * how to reach the author.
  *
- * $Id: channels.h 2.14 2011/08/06 09:56:13 kls Exp $
+ * $Id: channels.h 2.15 2012/03/11 11:46:39 kls Exp $
  */
 
 #ifndef __CHANNELS_H
@@ -200,6 +200,8 @@
 class cChannels : public cRwLock, public cConfig<cChannel> {
 private:
   int maxNumber;
+  int maxChannelNameLength;
+  int maxShortChannelNameLength;
   int modified;
   int beingEdited;
   cHash<cChannel> channelsHashSid;
@@ -224,6 +226,8 @@
   bool HasUniqueChannelID(cChannel *NewChannel, cChannel *OldChannel = NULL);
   bool SwitchTo(int Number);
   int MaxNumber(void) { return maxNumber; }
+  int MaxChannelNameLength(void);
+  int MaxShortChannelNameLength(void);
   void SetModified(bool ByUser = false);
   int Modified(void);
       ///< Returns 0 if no channels have been modified, 1 if an automatic
diff -ruN vdr-1.7.26/config.h vdr-1.7.27/config.h
--- vdr-1.7.26/config.h	2012-03-03 14:25:22.000000000 +0100
+++ vdr-1.7.27/config.h	2012-03-11 11:41:44.000000000 +0100
@@ -4,7 +4,7 @@
  * See the main source file 'vdr.c' for copyright information and
  * how to reach the author.
  *
- * $Id: config.h 2.44 2012/03/03 13:25:22 kls Exp $
+ * $Id: config.h 2.45 2012/03/11 10:41:44 kls Exp $
  */
 
 #ifndef __CONFIG_H
@@ -22,13 +22,13 @@
 
 // VDR's own version number:
 
-#define VDRVERSION  "1.7.26"
-#define VDRVERSNUM   10726  // Version * 10000 + Major * 100 + Minor
+#define VDRVERSION  "1.7.27"
+#define VDRVERSNUM   10727  // Version * 10000 + Major * 100 + Minor
 
 // The plugin API's version number:
 
-#define APIVERSION  "1.7.26"
-#define APIVERSNUM   10726  // Version * 10000 + Major * 100 + Minor
+#define APIVERSION  "1.7.27"
+#define APIVERSNUM   10727  // Version * 10000 + Major * 100 + Minor
 
 // When loading plugins, VDR searches them by their APIVERSION, which
 // may be smaller than VDRVERSION in case there have been no changes to
diff -ruN vdr-1.7.26/device.c vdr-1.7.27/device.c
--- vdr-1.7.26/device.c	2012-03-07 15:17:49.000000000 +0100
+++ vdr-1.7.27/device.c	2012-03-13 10:48:14.000000000 +0100
@@ -4,7 +4,7 @@
  * See the main source file 'vdr.c' for copyright information and
  * how to reach the author.
  *
- * $Id: device.c 2.57 2012/03/07 14:17:49 kls Exp $
+ * $Id: device.c 2.58 2012/03/13 09:48:14 kls Exp $
  */
 
 #include "device.h"
@@ -162,6 +162,11 @@
   return -1;
 }
 
+cString cDevice::DeviceName(void) const
+{
+  return "";
+}
+
 void cDevice::MakePrimaryDevice(bool On)
 {
   if (!On) {
diff -ruN vdr-1.7.26/device.h vdr-1.7.27/device.h
--- vdr-1.7.26/device.h	2012-03-06 13:13:46.000000000 +0100
+++ vdr-1.7.27/device.h	2012-03-13 11:17:16.000000000 +0100
@@ -4,7 +4,7 @@
  * See the main source file 'vdr.c' for copyright information and
  * how to reach the author.
  *
- * $Id: device.h 2.37 2012/03/06 12:13:46 kls Exp $
+ * $Id: device.h 2.38 2012/03/13 10:17:16 kls Exp $
  */
 
 #ifndef __DEVICE_H
@@ -201,6 +201,9 @@
          ///< Returns the card index of this device (0 ... MAXDEVICES - 1).
   int DeviceNumber(void) const;
          ///< Returns the number of this device (0 ... numDevices).
+  virtual cString DeviceName(void) const;
+         ///< Returns a string identifying the name of this device.
+         ///< The default implementation returns an empty string.
   virtual bool HasDecoder(void) const;
          ///< Tells whether this device has an MPEG decoder.
   virtual bool AvoidRecording(void) const { return false; }
diff -ruN vdr-1.7.26/dvbdevice.c vdr-1.7.27/dvbdevice.c
--- vdr-1.7.26/dvbdevice.c	2012-03-08 10:49:58.000000000 +0100
+++ vdr-1.7.27/dvbdevice.c	2012-03-25 12:41:45.000000000 +0200
@@ -4,7 +4,7 @@
  * See the main source file 'vdr.c' for copyright information and
  * how to reach the author.
  *
- * $Id: dvbdevice.c 2.67 2012/03/08 09:49:58 kls Exp $
+ * $Id: dvbdevice.c 2.69 2012/03/25 10:41:45 kls Exp $
  */
 
 #include "dvbdevice.h"
@@ -1090,6 +1090,11 @@
   return true;
 }
 
+cString cDvbDevice::DeviceName(void) const
+{
+  return frontendInfo.name;
+}
+
 bool cDvbDevice::Initialize(void)
 {
   new cDvbSourceParam('A', "ATSC");
@@ -1443,7 +1448,7 @@
 
   if (dvbTuner && ProvidesTransponder(Channel)) {
      result = hasPriority;
-     if (Priority >= 0) {
+     if (Priority > IDLEPRIORITY) {
         if (Receiving()) {
            if (dvbTuner->IsTunedTo(Channel)) {
               if (Channel->Vpid() && !HasPid(Channel->Vpid()) || Channel->Apid(0) && !HasPid(Channel->Apid(0)) || Channel->Dpid(0) && !HasPid(Channel->Dpid(0))) {
diff -ruN vdr-1.7.26/dvbdevice.h vdr-1.7.27/dvbdevice.h
--- vdr-1.7.26/dvbdevice.h	2012-02-29 13:20:51.000000000 +0100
+++ vdr-1.7.27/dvbdevice.h	2012-03-13 11:11:15.000000000 +0100
@@ -4,7 +4,7 @@
  * See the main source file 'vdr.c' for copyright information and
  * how to reach the author.
  *
- * $Id: dvbdevice.h 2.24 2012/02/29 12:20:51 kls Exp $
+ * $Id: dvbdevice.h 2.25 2012/03/13 10:11:15 kls Exp $
  */
 
 #ifndef __DVBDEVICE_H
@@ -138,6 +138,7 @@
   int Adapter(void) const { return adapter; }
   int Frontend(void) const { return frontend; }
   virtual bool Ready(void);
+  virtual cString DeviceName(void) const;
   static bool BondDevices(const char *Bondings);
        ///< Bonds the devices as defined in the given Bondings string.
        ///< A bonding is a sequence of device numbers (starting at 1),
diff -ruN vdr-1.7.26/dvbplayer.c vdr-1.7.27/dvbplayer.c
--- vdr-1.7.26/dvbplayer.c	2012-02-21 12:34:04.000000000 +0100
+++ vdr-1.7.27/dvbplayer.c	2012-03-12 15:36:55.000000000 +0100
@@ -4,7 +4,7 @@
  * See the main source file 'vdr.c' for copyright information and
  * how to reach the author.
  *
- * $Id: dvbplayer.c 2.25 2012/02/21 11:34:04 kls Exp $
+ * $Id: dvbplayer.c 2.26 2012/03/12 14:36:55 kls Exp $
  */
 
 #include "dvbplayer.h"
@@ -441,9 +441,9 @@
                          int NewIndex = readIndex + d;
                          if (NewIndex <= 0 && readIndex > 0)
                             NewIndex = 1; // make sure the very first frame is delivered
-                         NewIndex = index->GetNextIFrame(NewIndex, playDir == pdForward, &FileNumber, &FileOffset, &Length, TimeShiftMode);
+                         NewIndex = index->GetNextIFrame(NewIndex, playDir == pdForward, &FileNumber, &FileOffset, &Length);
                          if (NewIndex < 0 && TimeShiftMode && playDir == pdForward)
-                            SwitchToPlayFrame = Index;
+                            SwitchToPlayFrame = readIndex;
                          Index = NewIndex;
                          readIndependent = true;
                          }
@@ -452,7 +452,7 @@
                          if (!NextFile(FileNumber, FileOffset))
                             continue;
                          }
-                      else
+                      else if (!(TimeShiftMode && playDir == pdForward))
                          eof = true;
                       }
                    else if (index) {
@@ -486,16 +486,16 @@
                          }
                       readFrame = new cFrame(b, -r, ftUnknown, readIndex, Pts); // hands over b to the ringBuffer
                       }
-                   else if (r < 0 && errno == EAGAIN)
-                      WaitingForData = true;
-                   else {
-                      if (r == 0)
-                         eof = true;
-                      else if (r < 0 && FATALERRNO) {
+                   else if (r < 0) {
+                      if (errno == EAGAIN)
+                         WaitingForData = true;
+                      else if (FATALERRNO) {
                          LOG_ERROR;
                          break;
                          }
                       }
+                   else
+                      eof = true;
                    }
                 }
 
@@ -764,7 +764,7 @@
      if (Index >= 0) {
         Index = max(Index + SecondsToFrames(Seconds, framesPerSecond), 0);
         if (Index > 0)
-           Index = index->GetNextIFrame(Index, false, NULL, NULL, NULL, true);
+           Index = index->GetNextIFrame(Index, false, NULL, NULL, NULL);
         if (Index >= 0)
            readIndex = Index - 1; // Action() will first increment it!
         }
diff -ruN vdr-1.7.26/dvbsubtitle.c vdr-1.7.27/dvbsubtitle.c
--- vdr-1.7.26/dvbsubtitle.c	2012-03-02 11:47:25.000000000 +0100
+++ vdr-1.7.27/dvbsubtitle.c	2012-03-16 12:56:56.000000000 +0100
@@ -4,10 +4,10 @@
  * See the main source file 'vdr.c' for copyright information and
  * how to reach the author.
  *
- * Original author: Marco Schlüßler <marco@lordzodiac.de>
+ * Original author: Marco Schluessler <marco@lordzodiac.de>
  * With some input from the "subtitle plugin" by Pekka Virtanen <pekka.virtanen@sci.fi>
  *
- * $Id: dvbsubtitle.c 2.27 2012/03/02 10:47:25 kls Exp $
+ * $Id: dvbsubtitle.c 2.31 2012/03/16 11:56:56 kls Exp $
  */
 
 
@@ -491,13 +491,14 @@
   const cPalette *palette = Clut ? Clut->GetPalette(Depth()) : NULL;
   for (cSubtitleObject *so = objects.First(); so && palette; so = objects.Next(so)) {
       if (Utf8StrLen(so->TextData()) > 0) {
-         const cFont *font = cFont::GetFont(fontOsd);
-         cBitmap *tmp = new cBitmap(font->Width(so->TextData()), font->Height(), Depth());
+         cFont *font = cFont::CreateFont(Setup.FontOsd, Setup.FontOsdSize);
+         cBitmap tmp(font->Width(so->TextData()), font->Height(), Depth());
          double factor = (double)lineHeight / font->Height();
-         tmp->DrawText(0, 0, so->TextData(), palette->Color(so->ForegroundPixelCode()), palette->Color(so->BackgroundPixelCode()), font);
-         tmp = tmp->Scaled(factor, factor, true);
-         DrawBitmap(so->X(), so->Y(), *tmp);
-         DELETENULL(tmp);
+         tmp.DrawText(0, 0, so->TextData(), palette->Color(so->ForegroundPixelCode()), palette->Color(so->BackgroundPixelCode()), font);
+         cBitmap *scaled = tmp.Scaled(factor, factor, true);
+         DrawBitmap(so->X(), so->Y(), *scaled);
+         delete scaled;
+         delete font;
          }
       }
 }
@@ -1280,9 +1281,16 @@
         else
            return; // unable to draw bitmaps
         }
-  if (Reduced) {
-     for (int i = 0; i < NumAreas; i++) {
-         cSubtitleRegion *sr = Page->regions.Get(i);
+  cDvbSubtitleBitmaps *Bitmaps = new cDvbSubtitleBitmaps(Page->Pts(), Page->Timeout(), Areas, NumAreas, osdFactorX, osdFactorY);
+  bitmaps->Add(Bitmaps);
+  for (int i = 0; i < NumAreas; i++) { 
+      cSubtitleRegion *sr = Page->regions.Get(i);
+      cSubtitleClut *clut = Page->GetClutById(sr->ClutId());
+      if (!clut)
+         continue;
+      sr->Replace(*clut->GetPalette(sr->Bpp()));
+      sr->UpdateTextData(clut);
+      if (Reduced) {
          if (sr->Bpp() != Areas[i].bpp) {
             if (sr->Level() <= Areas[i].bpp) {
                //TODO this is untested - didn't have any such subtitle stream
@@ -1298,15 +1306,6 @@
                }
             }
          }
-     }
-  cDvbSubtitleBitmaps *Bitmaps = new cDvbSubtitleBitmaps(Page->Pts(), Page->Timeout(), Areas, NumAreas, osdFactorX, osdFactorY);
-  bitmaps->Add(Bitmaps);
-  for (cSubtitleRegion *sr = Page->regions.First(); sr; sr = Page->regions.Next(sr)) {
-      cSubtitleClut *clut = Page->GetClutById(sr->ClutId());
-      if (!clut)
-         continue;
-      sr->Replace(*clut->GetPalette(sr->Bpp()));
-      sr->UpdateTextData(clut);
       int posX = sr->HorizontalAddress();
       int posY = sr->VerticalAddress();
       if (sr->Width() > 0 && sr->Height() > 0) {
diff -ruN vdr-1.7.26/dvbsubtitle.h vdr-1.7.27/dvbsubtitle.h
--- vdr-1.7.26/dvbsubtitle.h	2011-03-20 14:34:23.000000000 +0100
+++ vdr-1.7.27/dvbsubtitle.h	2012-03-11 14:34:12.000000000 +0100
@@ -4,9 +4,9 @@
  * See the main source file 'vdr.c' for copyright information and
  * how to reach the author.
  *
- * Original author: Marco Schlüßler <marco@lordzodiac.de>
+ * Original author: Marco Schluessler <marco@lordzodiac.de>
  *
- * $Id: dvbsubtitle.h 2.6 2011/03/20 13:34:23 kls Exp $
+ * $Id: dvbsubtitle.h 2.7 2012/03/11 13:34:12 kls Exp $
  */
 
 #ifndef __DVBSUBTITLE_H
diff -ruN vdr-1.7.26/eit.c vdr-1.7.27/eit.c
--- vdr-1.7.26/eit.c	2012-03-10 15:43:52.000000000 +0100
+++ vdr-1.7.27/eit.c	2012-03-14 11:11:15.000000000 +0100
@@ -8,7 +8,7 @@
  * Robert Schneider <Robert.Schneider@web.de> and Rolf Hakenes <hakenes@hippomi.de>.
  * Adapted to 'libsi' for VDR 1.3.0 by Marcel Wiesweg <marcel.wiesweg@gmx.de>.
  *
- * $Id: eit.c 2.15 2012/03/10 14:43:52 kls Exp $
+ * $Id: eit.c 2.16 2012/03/14 10:11:15 kls Exp $
  */
 
 #include "eit.h"
@@ -32,12 +32,18 @@
   if (!CheckCRCAndParse())
      return;
 
+  time_t Now = time(NULL);
+  if (Now < VALID_TIME)
+     return; // we need the current time for handling PDC descriptors
+
+  if (!Channels.Lock(false, 10))
+     return;
   tChannelID channelID(Source, getOriginalNetworkId(), getTransportStreamId(), getServiceId());
   cChannel *channel = Channels.GetByChannelID(channelID, true);
-  if (!channel)
-     return; // only collect data for known channels
-  if (EpgHandlers.IgnoreChannel(channel))
+  if (!channel || EpgHandlers.IgnoreChannel(channel)) {
+     Channels.Unlock();
      return;
+     }
 
   cSchedule *pSchedule = (cSchedule *)Schedules->GetSchedule(channel, true);
 
@@ -45,13 +51,9 @@
   bool Modified = false;
   time_t SegmentStart = 0;
   time_t SegmentEnd = 0;
-  time_t Now = time(NULL);
   struct tm tm_r;
   struct tm t = *localtime_r(&Now, &tm_r); // this initializes the time zone in 't'
 
-  if (Now < VALID_TIME)
-     return; // we need the current time for handling PDC descriptors
-
   SI::EIT::Event SiEitEvent;
   for (SI::Loop::Iterator it; eventLoop.getNext(SiEitEvent, it); ) {
       if (EpgHandlers.HandleEitEvent(pSchedule, &SiEitEvent, Tid, getVersionNumber()))
@@ -295,13 +297,12 @@
         pSchedule->ClrRunningStatus(channel);
      pSchedule->SetPresentSeen();
      }
-  if (OnlyRunningStatus)
-     return;
-  if (Modified) {
+  if (Modified && !OnlyRunningStatus) {
      EpgHandlers.SortSchedule(pSchedule);
      EpgHandlers.DropOutdated(pSchedule, SegmentStart, SegmentEnd, Tid, getVersionNumber());
      Schedules->SetModified(pSchedule);
      }
+  Channels.Unlock();
 }
 
 // --- cTDT ------------------------------------------------------------------
diff -ruN vdr-1.7.26/i18n-to-gettext vdr-1.7.27/i18n-to-gettext
--- vdr-1.7.26/i18n-to-gettext	2011-12-04 15:17:35.000000000 +0100
+++ vdr-1.7.27/i18n-to-gettext	1970-01-01 01:00:00.000000000 +0100
@@ -1,347 +0,0 @@
-#!/usr/bin/perl -w
-
-# Convert i18n texts to gettext
-#
-# Extracts all texts from the file i18n.c and creates language
-# specific *.po files.
-#
-# Usage: i18n-to-gettext
-#
-# See the main source file 'vdr.c' for copyright information and
-# how to reach the author.
-#
-# $Id: i18n-to-gettext 2.2 2011/12/04 14:17:35 kls Exp $
-
-# How to convert an actual plugin:
-#
-# - If your code contains something like
-#
-#   const char *Text = "Some text";
-#   ...
-#   Function(tr(Text));
-#
-#   you need to enclose the text constant in trNOOP(...), as in
-#
-#   const char *Text = trNOOP("Some text");
-#
-#   The actual usage of the tr() macro remains unchanged.
-#
-# - If you have comments following the texts in your i18n.c file
-#   that should be seen by the translators, move them from the
-#   i18n.c file into the file where the text is actually used,
-#   and mark them with the TRANSLATORS keyword, as in
-#
-#   // TRANSLATORS: note the plural!
-#   Add(new cMenuEditIntItem( tr("Setup.EPG$Preferred languages"), ...
-#
-# - Fill in your email address in the line
-#   $MSGIDBUGS = "" ...
-#   below, so that users can reach you in case there is a problem
-#   with a message id.
-#
-# - Run this Perl script from within your plugin's source directory.
-#   This script will run 'xgettext' to extract all of your texts
-#   into a file named <pluginname>.pot. After that it will extract
-#   your existing i18n texts from the file i18n.c (or wherever you
-#   have defined them) and generate *.po files for all languages
-#   currently known by VDR.
-#
-# - Your Makefile will be automatically adjusted to allow for
-#   building the *.mo files necessary for supporting gettext().
-#   Please check carefully whether the automatic adjustments have
-#   succeeded, though. The modified Makefile will be written to
-#   Makefile.new, so you can call this script any numer of times
-#   in case you need to do some fine tuning of your texts (especially
-#   adding some trNOOP() in case the script reports "missing phrases".
-#   Once you're done converting your plugin source to using gettext,
-#   rename Makefile.new to Makefile.
-#
-# - You may want to remove the old internationalized texts from your
-#   source. Usually this means removing the files i18n.[hc], stripping
-#   i18n.o from the OBJS variable in the Makefile and removing all
-#   '#include "i18n.h"' lines from the rest of your source files.
-#   These steps are not done automatically.
-
-# Check for the existence of a Makefile:
-
-die "Makefile not found!" unless (-f "Makefile");
-
-# Determine the plugin name:
-
-$PLUGIN = `grep '^PLUGIN *=' Makefile | head -1` || die "can't find plugin name!";
-$PLUGIN =~ s/.*= *(.*)\n/$1/;
-die "can't find plugin name!" unless ($PLUGIN);
-
-# Locate the file containing the texts:
-
-$I18NFILE = "";
-for ("i18n.c", "i18n.h", `ls *.c`) { # try i18n.[ch] explicitly first
-    chomp($f = $_);
-    if (-f $f && `grep tI18nPhrase $f`) {
-       $I18NFILE = $f;
-       last;
-       }
-    }
-die "can't find internationalized texts!" unless ($I18NFILE);
-
-# Plugin specific information:
-
-$TITLE = "VDR plugin language source file";
-$COPYRIGHT = "2007 Klaus Schmidinger <kls\@tvdr.de>";
-$PACKAGE = "VDR";
-$VERSION = "1.5.7";
-$MSGIDBUGS = "" || die "enter your email address here"; # escape the '@', as in "user\@domain.tld"
-$LANGUAGETEAM = "<vdr\@linuxtv.org>";
-
-# Gettext environment:
-
-$XGETTEXT = "xgettext -C -cTRANSLATORS --no-wrap -F -k -ktr -ktrNOOP --msgid-bugs-address='$MSGIDBUGS'";
-$PODIR = "po";
-$POTFILE = "$PODIR/$PLUGIN.pot";
-
-# Languages as known by VDR 1.5.6:
-
-@LANGS = (
-  "en_US",
-  "de_DE",
-  "sl_SI",
-  "it_IT",
-  "nl_NL",
-  "pt_PT",
-  "fr_FR",
-  "nn_NO",
-  "fi_FI",
-  "pl_PL",
-  "es_ES",
-  "el_GR",
-  "sv_SE",
-  "ro_RO",
-  "hu_HU",
-  "ca_ES",
-  "ru_RU",
-  "hr_HR",
-  "et_EE",
-  "da_DK",
-  "cs_CZ",
-  "tr_TR"
-  );
-
-@CHARSETS = (
-  "ISO-8859-15",
-  "ISO-8859-15",
-  "ISO-8859-2",
-  "ISO-8859-15",
-  "ISO-8859-15",
-  "ISO-8859-1",
-  "ISO-8859-1",
-  "ISO-8859-1",
-  "ISO-8859-15",
-  "ISO-8859-2",
-  "ISO-8859-15",
-  "ISO-8859-7",
-  "ISO-8859-1",
-  "ISO-8859-2",
-  "ISO-8859-2",
-  "ISO-8859-1",
-  "ISO-8859-5",
-  "ISO-8859-2",
-  "ISO-8859-13",
-  "ISO-8859-15",
-  "ISO-8859-2",
-  "ISO-8859-9",
-  );
-
-@TRANSLATORS = (
-  "Klaus Schmidinger <kls\@tvdr.de>, 2000",
-  "Klaus Schmidinger <kls\@tvdr.de>, 2000",
-  "Miha Setina <mihasetina\@softhome.net>, 2000; Matjaz Thaler <matjaz.thaler\@guest.arnes.si>, 2003",
-  "Alberto Carraro <bertocar\@tin.it>, 2001; Antonio Ospite <ospite\@studenti.unina.it>, 2003; Sean Carlos <seanc\@libero.it>, 2005",
-  "Arnold Niessen <niessen\@iae.nl> <arnold.niessen\@philips.com>, 2001; Hans Dingemans <hans.dingemans\@tacticalops.nl>, 2003; Maarten Wisse <Maarten.Wisse\@urz.uni-hd.de>, 2005",
-  "Paulo Lopes <pmml\@netvita.pt>, 2001",
-  "Jean-Claude Repetto <jc\@repetto.org>, 2001; Olivier Jacques <jacquesolivier\@hotmail.com>, 2003; Gregoire Favre <greg\@magma.unil.ch>, 2003; Nicolas Huillard <nhuillard\@e-dition.fr>, 2005",
-  "Jørgen Tvedt <pjtvedt\@online.no>, 2001; Truls Slevigen <truls\@slevigen.no>, 2002",
-  "Hannu Savolainen <hannu\@opensound.com>, 2002; Jaakko Hyvätti <jaakko\@hyvatti.iki.fi>, 2002; Niko Tarnanen <niko.tarnanen\@hut.fi>, 2003; Rolf Ahrenberg <rahrenbe\@cc.hut.fi>, 2003",
-  "Michael Rakowski <mrak\@gmx.de>, 2002",
-  "Ruben Nunez Francisco <ruben.nunez\@tang-it.com>, 2002",
-  "Dimitrios Dimitrakos <mail\@dimitrios.de>, 2002",
-  "Tomas Prybil <tomas\@prybil.se>, 2002; Jan Ekholm <chakie\@infa.abo.fi>, 2003",
-  "Paul Lacatus <paul\@campina.iiruc.ro>, 2002; Lucian Muresan <lucianm\@users.sourceforge.net>, 2004",
-  "Istvan Koenigsberger <istvnko\@hotmail.com>, 2002; Guido Josten <guido.josten\@t-online.de>, 2002",
-  "Marc Rovira Vall <tm05462\@salleURL.edu>, 2003; Ramon Roca <ramon.roca\@xcombo.com>, 2003; Jordi Vilà <jvila\@tinet.org>, 2003",
-  "Vyacheslav Dikonov <sdiconov\@mail.ru>, 2004",
-  "Drazen Dupor <drazen.dupor\@dupor.com>, 2004; Dino Ravnic <dino.ravnic\@fer.hr>, 2004",
-  "Arthur Konovalov <kasjas\@hot.ee>, 2004",
-  "Mogens Elneff <mogens\@elneff.dk>, 2004",
-  "Vladimír Bárta <vladimir.barta\@k2atmitec.cz>, 2006",
-  "Oktay Yolgeçen <oktay_73\@yahoo.de>, 2007"
-  );
-
-@LASTTRANSLATOR = (
-  "Klaus Schmidinger <kls\@tvdr.de>",
-  "Klaus Schmidinger <kls\@tvdr.de>",
-  "Matjaz Thaler <matjaz.thaler\@guest.arnes.si>",
-  "Sean Carlos <seanc\@libero.it>",
-  "Maarten Wisse <Maarten.Wisse\@urz.uni-hd.de>",
-  "Paulo Lopes <pmml\@netvita.pt>",
-  "Nicolas Huillard <nhuillard\@e-dition.fr>",
-  "Truls Slevigen <truls\@slevigen.no>",
-  "Rolf Ahrenberg <rahrenbe\@cc.hut.fi>",
-  "Michael Rakowski <mrak\@gmx.de>",
-  "Ruben Nunez Francisco <ruben.nunez\@tang-it.com>",
-  "Dimitrios Dimitrakos <mail\@dimitrios.de>",
-  "Tomas Prybil <tomas\@prybil.se>",
-  "Lucian Muresan <lucianm\@users.sourceforge.net>",
-  "Istvan Koenigsberger <istvnko\@hotmail.com>, Guido Josten <guido.josten\@t-online.de>",
-  "Jordi Vilà <jvila\@tinet.org>",
-  "Vyacheslav Dikonov <sdiconov\@mail.ru>",
-  "Drazen Dupor <drazen.dupor\@dupor.com>",
-  "Arthur Konovalov <kasjas\@hot.ee>",
-  "Mogens Elneff <mogens\@elneff.dk>",
-  "Vladimír Bárta <vladimir.barta\@k2atmitec.cz>",
-  "Oktay Yolgeçen <oktay_73\@yahoo.de>"
-  );
-
-# Collect all translated texts:
-
-open(F, $I18NFILE) || die "$I18NFILE: $!\n";
-$InComment = 0;
-while (<F>) {
-      chomp;
-      s/\t/ /g; # get rid of tabs
-      s/  *$//; # get rid of trailing blanks
-      s/^ *\/\/.*//; # remove comment lines
-      s/ *\/\/.*//; # strip trailing comments
-      s/\/\*.*\*\///g; # strip c comments
-      if (/\/\*/) {
-         $InComment = 1;
-         s/\/\*.*$//; # remove start of comment
-         }
-      elsif (/\*\//) {
-         $InComment = 0;
-         s/^.*\*\///; # remove end of comment
-         }
-      elsif ($InComment) {
-         next;
-         }
-      next if (/^ *$/); # skip empty lines
-      next if (/#if/);
-      next if (/#endif/);
-      next unless ($found or $found = /const *tI18nPhrase .*{/); # sync on phrases
-      next if (/const *tI18nPhrase .*{/); # skip sync line
-      last if (/{ *NULL *}/); # stop after last phrase
-      if (/{ *(.*),/) {
-         $Original = $1;
-         $Index = 0;
-         }
-      elsif (/}/) {
-         }
-      else {
-         $Translated = $_;
-         $Translated =~ s/ *(.*),/$1/;
-         $Index++;
-         $Map{$Original}[$Index] = $Translated;
-         }
-      }
-close(F);
-
-# Generate the .pot file:
-
-(mkdir($PODIR) || die "$PODIR: $!\n") unless -d $PODIR;
-
-system("$XGETTEXT -o $POTFILE *.c");
-
-# Generate .po files for all languages:
-
-open(POT, $POTFILE) || die "$POTFILE: $!\n";
-@POT = <POT>;
-close(POT);
-
-for ($Index = 1; $LANGS[$Index]; $Index++) {
-
-    $Authors = "# " . join("\n# ", split(/; */, $TRANSLATORS[$Index])) . "\n";
-
-    $POFILE = "$PODIR/$LANGS[$Index].po";
-    open(PO, ">$POFILE") || die "$POFILE: $!\n";
-    $msgid = "";
-    for (@POT) {
-        next if (/^#, fuzzy$/); # skip the 'fuzzy' keyword
-        $msgid = $1 if (/^msgid (".+")/);
-        $date = $1 if (/POT-Creation-Date: (.*)\\n/);
-        $s = $_;
-        if (!$msgid) {
-           $s =~ s/SOME DESCRIPTIVE TITLE/$TITLE/;
-           $s =~ s/YEAR THE PACKAGE'S COPYRIGHT HOLDER/$COPYRIGHT/;
-           $s =~ s/PACKAGE/$PACKAGE/;
-           $s =~ s/VERSION/$VERSION/;
-           $s = $Authors if (/FIRST AUTHOR/);
-           $s =~ s/YEAR-MO-DA HO:MI\+ZONE/$date/;
-           $s =~ s/FULL NAME <EMAIL\@ADDRESS>/$LASTTRANSLATOR[$Index]/;
-           $s =~ s/LANGUAGE <LL\@li\.org>/$LANGUAGETEAM/;
-           $s =~ s/CHARSET/$CHARSETS[$Index]/;
-           }
-        else {
-           $s =~ s/""/$Map{$msgid}[$Index]/ if ($msgid && /^msgstr ""/ && defined $Map{$msgid}[$Index]);
-           $Used{$msgid} = 1;
-           }
-        print PO $s;
-        }
-    close(PO);
-    }
-
-# Report missing phrases:
-
-for (keys %Map) {
-    push(@Missing, "$_\n") unless $Used{$_};
-    }
-
-if (@Missing) {
-   print "Missing phrases (may need to use trNOOP):\n\n";
-   print sort(@Missing);
-   }
-
-# Adjust the Makefile:
-
-$MAKEI18N = q{### Internationalization (I18N):
-
-PODIR     = po
-LOCALEDIR = $(VDRDIR)/locale
-I18Npo    = $(wildcard $(PODIR)/*.po)
-I18Nmsgs  = $(addprefix $(LOCALEDIR)/, $(addsuffix /LC_MESSAGES/vdr-$(PLUGIN).mo, $(notdir $(foreach file, $(I18Npo), $(basename $(file))))))
-I18Npot   = $(PODIR)/$(PLUGIN).pot
-
-%.mo: %.po
-	msgfmt -c -o $@ $<
-
-$(I18Npot): $(wildcard *.c)
-	xgettext -C -cTRANSLATORS --no-wrap --no-location -k -ktr -ktrNOOP --msgid-bugs-address='<} . $MSGIDBUGS . q{>' -o $@ $^
-
-%.po: $(I18Npot)
-	msgmerge -U --no-wrap --no-location --backup=none -q $@ $<
-	@touch $@
-
-$(I18Nmsgs): $(LOCALEDIR)/%/LC_MESSAGES/vdr-$(PLUGIN).mo: $(PODIR)/%.mo
-	@mkdir -p $(dir $@)
-	cp $< $@
-
-.PHONY: i18n
-i18n: $(I18Nmsgs)
-
-};
-
-open(OLD, "Makefile") || die "Makefile: $!";
-open(NEW, ">Makefile.new") || die "Makefile.new: $!";
-while (<OLD>) {
-      chomp;
-      if (/Targets:/) {
-         print NEW $MAKEI18N;
-         }
-      elsif (/^all:/) {
-         $_ .= " i18n";
-         }
-      elsif (/^clean:/) {
-         $_ .= "\n\t\@-rm -f \$(PODIR)/*.mo \$(PODIR)/*.pot";
-         }
-      print NEW "$_\n";
-      }
-close(NEW);
-close(OLD);
diff -ruN vdr-1.7.26/i18n.h vdr-1.7.27/i18n.h
--- vdr-1.7.26/i18n.h	2008-01-19 12:56:19.000000000 +0100
+++ vdr-1.7.27/i18n.h	2012-03-11 15:07:45.000000000 +0100
@@ -4,7 +4,7 @@
  * See the main source file 'vdr.c' for copyright information and
  * how to reach the author.
  *
- * $Id: i18n.h 2.0 2008/01/19 11:56:19 kls Exp $
+ * $Id: i18n.h 2.1 2012/03/11 14:07:45 kls Exp $
  */
 
 #ifndef __I18N_H
@@ -13,8 +13,6 @@
 #include <stdio.h>
 #include "tools.h"
 
-typedef const char *tI18nPhrase[22]; ///< obsolete - switch to 'gettext'!
-
 #define I18N_DEFAULT_LOCALE "en_US"
 #define I18N_MAX_LOCALE_LEN 16       // for buffers that hold en_US etc.
 #define I18N_MAX_LANGUAGES  256      // for buffers that hold all available languages
diff -ruN vdr-1.7.26/menu.c vdr-1.7.27/menu.c
--- vdr-1.7.26/menu.c	2012-03-08 14:32:44.000000000 +0100
+++ vdr-1.7.27/menu.c	2012-03-13 14:14:38.000000000 +0100
@@ -4,7 +4,7 @@
  * See the main source file 'vdr.c' for copyright information and
  * how to reach the author.
  *
- * $Id: menu.c 2.42 2012/03/08 13:32:44 kls Exp $
+ * $Id: menu.c 2.45 2012/03/13 13:14:38 kls Exp $
  */
 
 #include "menu.h"
@@ -49,6 +49,7 @@
 #define NODISKSPACEDELTA  300 // seconds between "Not enough disk space to start recording!" messages
 
 #define CHNUMWIDTH  (numdigits(Channels.MaxNumber()) + 1)
+#define CHNAMWIDTH  (Channels.MaxShortChannelNameLength() + 1)
 
 // --- cFreeDiskSpace --------------------------------------------------------
 
@@ -77,7 +78,10 @@
      int Percent = VideoDiskSpace(&FreeMB);
      lastDiskSpaceCheck = time(NULL);
      if (ForceCheck || FreeMB != lastFreeMB) {
-        int Minutes = int(double(FreeMB) / MB_PER_MINUTE);
+        int MBperMinute = Recordings.MBperMinute();
+        if (MBperMinute <= 0)
+           MBperMinute = MB_PER_MINUTE;
+        int Minutes = int(double(FreeMB) / MBperMinute);
         int Hours = Minutes / 60;
         Minutes %= 60;
         freeDiskSpaceString = cString::sprintf("%s %d%%  -  %2d:%02d %s", tr("Disk"), Percent, Hours, Minutes, tr("free"));
@@ -935,7 +939,7 @@
 
 void cMenuEditTimer::SetHelpKeys(void)
 {
-  SetHelp(tr("Button$Folder"), data.weekdays ? tr("Button$Once") : tr("Button$Repeating"));
+  SetHelp(tr("Button$Folder"), data.weekdays ? tr("Button$Single") : tr("Button$Repeating"));
 }
 
 void cMenuEditTimer::SetFirstDayItem(void)
@@ -1347,9 +1351,9 @@
      const char *csn = channel ? channel->ShortName(true) : NULL;
      cString eds = event->GetDateString();
      if (channel && withDate)
-        buffer = cString::sprintf("%d\t%.*s\t%.*s\t%s\t%c%c%c\t%s", channel->Number(), Utf8SymChars(csn, 6), csn, Utf8SymChars(eds, 6), *eds, *event->GetTimeString(), t, v, r, event->Title());
+        buffer = cString::sprintf("%d\t%.*s\t%.*s\t%s\t%c%c%c\t%s", channel->Number(), Utf8SymChars(csn, 999), csn, Utf8SymChars(eds, 6), *eds, *event->GetTimeString(), t, v, r, event->Title());
      else if (channel)
-        buffer = cString::sprintf("%d\t%.*s\t%s\t%c%c%c\t%s", channel->Number(), Utf8SymChars(csn, 6), csn, *event->GetTimeString(), t, v, r, event->Title());
+        buffer = cString::sprintf("%d\t%.*s\t%s\t%c%c%c\t%s", channel->Number(), Utf8SymChars(csn, 999), csn, *event->GetTimeString(), t, v, r, event->Title());
      else
         buffer = cString::sprintf("%.*s\t%s\t%c%c%c\t%s", Utf8SymChars(eds, 6), *eds, *event->GetTimeString(), t, v, r, event->Title());
      SetText(buffer);
@@ -1383,7 +1387,7 @@
 const cEvent *cMenuWhatsOn::scheduleEvent = NULL;
 
 cMenuWhatsOn::cMenuWhatsOn(const cSchedules *Schedules, bool Now, int CurrentChannelNr)
-:cOsdMenu(Now ? tr("What's on now?") : tr("What's on next?"), CHNUMWIDTH, 7, 6, 4)
+:cOsdMenu(Now ? tr("What's on now?") : tr("What's on next?"), CHNUMWIDTH, CHNAMWIDTH, 6, 4)
 {
   now = Now;
   helpKeys = -1;
@@ -1607,7 +1611,7 @@
 void cMenuSchedule::PrepareScheduleThisAll(const cEvent *Event, const cChannel *Channel)
 {
   Clear();
-  SetCols(CHNUMWIDTH, 7, 7, 6, 4);
+  SetCols(CHNUMWIDTH, CHNAMWIDTH, 7, 6, 4);
   SetTitle(tr("This event - all channels"));
   if (schedules && Event) {
      for (cChannel *ch = Channels.First(); ch; ch = Channels.Next(ch)) {
@@ -1626,7 +1630,7 @@
 void cMenuSchedule::PrepareScheduleAllAll(const cEvent *Event, const cChannel *Channel)
 {
   Clear();
-  SetCols(CHNUMWIDTH, 7, 7, 6, 4);
+  SetCols(CHNUMWIDTH, CHNAMWIDTH, 7, 6, 4);
   SetTitle(tr("All events - all channels"));
   if (schedules) {
      for (cChannel *ch = Channels.First(); ch; ch = Channels.Next(ch)) {
diff -ruN vdr-1.7.26/menuitems.c vdr-1.7.27/menuitems.c
--- vdr-1.7.26/menuitems.c	2012-03-08 14:22:22.000000000 +0100
+++ vdr-1.7.27/menuitems.c	2012-03-13 12:21:57.000000000 +0100
@@ -4,7 +4,7 @@
  * See the main source file 'vdr.c' for copyright information and
  * how to reach the author.
  *
- * $Id: menuitems.c 2.12 2012/03/08 13:22:22 kls Exp $
+ * $Id: menuitems.c 2.13 2012/03/13 11:21:57 kls Exp $
  */
 
 #include "menuitems.h"
@@ -855,6 +855,7 @@
   value = Value;
   weekdays = WeekDays;
   oldvalue = 0;
+  oldweekdays = 0;
   dayindex = weekdays ? FindDayIndex(*weekdays) : 0;
   Set();
 }
@@ -892,10 +893,12 @@
      if (*weekdays) {
         *value = cTimer::SetTime(oldvalue ? oldvalue : time(NULL), 0);
         oldvalue = 0;
+        oldweekdays = *weekdays;
         *weekdays = 0;
         }
      else {
-        *weekdays = days[cTimer::GetWDay(*value)];
+        *weekdays = oldweekdays ? oldweekdays : days[cTimer::GetWDay(*value)];
+        oldweekdays = 0;
         dayindex = FindDayIndex(*weekdays);
         oldvalue = *value;
         *value = 0;
diff -ruN vdr-1.7.26/menuitems.h vdr-1.7.27/menuitems.h
--- vdr-1.7.26/menuitems.h	2012-03-08 13:38:46.000000000 +0100
+++ vdr-1.7.27/menuitems.h	2012-03-13 12:19:11.000000000 +0100
@@ -4,7 +4,7 @@
  * See the main source file 'vdr.c' for copyright information and
  * how to reach the author.
  *
- * $Id: menuitems.h 2.7 2012/03/08 12:38:46 kls Exp $
+ * $Id: menuitems.h 2.8 2012/03/13 11:19:11 kls Exp $
  */
 
 #ifndef __MENUITEMS_H
@@ -163,6 +163,7 @@
   time_t *value;
   int *weekdays;
   time_t oldvalue;
+  int oldweekdays;
   int dayindex;
   int FindDayIndex(int WeekDays);
   virtual void Set(void);
diff -ruN vdr-1.7.26/newplugin vdr-1.7.27/newplugin
--- vdr-1.7.26/newplugin	2012-01-18 13:32:31.000000000 +0100
+++ vdr-1.7.27/newplugin	2012-03-11 16:34:26.000000000 +0100
@@ -12,7 +12,7 @@
 # See the main source file 'vdr.c' for copyright information and
 # how to reach the author.
 #
-# $Id: newplugin 2.7 2012/01/18 12:32:31 kls Exp $
+# $Id: newplugin 2.8 2012/03/11 15:34:26 kls Exp $
 
 $PLUGIN_NAME = $ARGV[0] || die "Usage: newplugin <name>\n";
 
@@ -77,7 +77,7 @@
 ### The C++ compiler and options:
 
 CXX      ?= g++
-CXXFLAGS ?= -g -O3 -Wall -Woverloaded-virtual -Wno-parentheses
+CXXFLAGS ?= -g -O3 -Wall -Werror=overloaded-virtual -Wno-parentheses
 
 ### The directory environment:
 
diff -ruN vdr-1.7.26/plugin.c vdr-1.7.27/plugin.c
--- vdr-1.7.26/plugin.c	2010-01-06 12:36:46.000000000 +0100
+++ vdr-1.7.27/plugin.c	2012-03-11 14:56:02.000000000 +0100
@@ -4,7 +4,7 @@
  * See the main source file 'vdr.c' for copyright information and
  * how to reach the author.
  *
- * $Id: plugin.c 2.2 2010/01/06 11:36:46 kls Exp $
+ * $Id: plugin.c 2.3 2012/03/11 13:56:02 kls Exp $
  */
 
 #include "plugin.h"
@@ -130,11 +130,6 @@
   return NULL;
 }
 
-void cPlugin::RegisterI18n(const void *)
-{
-  dsyslog("plugin '%s' called obsolete function RegisterI18n()", Name());
-}
-
 void cPlugin::SetConfigDirectory(const char *Dir)
 {
   free(configDirectory);
diff -ruN vdr-1.7.26/plugin.h vdr-1.7.27/plugin.h
--- vdr-1.7.26/plugin.h	2007-08-04 11:56:26.000000000 +0200
+++ vdr-1.7.27/plugin.h	2012-03-11 14:55:56.000000000 +0100
@@ -4,7 +4,7 @@
  * See the main source file 'vdr.c' for copyright information and
  * how to reach the author.
  *
- * $Id: plugin.h 2.0 2007/08/04 09:56:26 kls Exp $
+ * $Id: plugin.h 2.1 2012/03/11 13:55:56 kls Exp $
  */
 
 #ifndef __PLUGIN_H
@@ -51,8 +51,6 @@
   void SetupStore(const char *Name, const char *Value = NULL);
   void SetupStore(const char *Name, int Value);
 
-  void RegisterI18n(const void *); ///< This function is obsolete and may be removed in future versions of VDR!
-
   virtual bool Service(const char *Id, void *Data = NULL);
   virtual const char **SVDRPHelpPages(void);
   virtual cString SVDRPCommand(const char *Command, const char *Option, int &ReplyCode);
diff -ruN vdr-1.7.26/po/ar.po vdr-1.7.27/po/ar.po
--- vdr-1.7.26/po/ar.po	2012-03-08 14:37:16.000000000 +0100
+++ vdr-1.7.27/po/ar.po	2012-03-11 11:44:44.000000000 +0100
@@ -660,7 +660,7 @@
 msgid "Button$Folder"
 msgstr "Ø§ÙÙÙØ¡ÙØª"
 
-msgid "Button$Once"
+msgid "Button$Single"
 msgstr ""
 
 msgid "Button$Repeating"
diff -ruN vdr-1.7.26/po/ca_ES.po vdr-1.7.27/po/ca_ES.po
--- vdr-1.7.26/po/ca_ES.po	2012-03-08 14:37:15.000000000 +0100
+++ vdr-1.7.27/po/ca_ES.po	2012-03-11 11:44:43.000000000 +0100
@@ -651,7 +651,7 @@
 msgid "Button$Folder"
 msgstr ""
 
-msgid "Button$Once"
+msgid "Button$Single"
 msgstr ""
 
 msgid "Button$Repeating"
diff -ruN vdr-1.7.26/po/cs_CZ.po vdr-1.7.27/po/cs_CZ.po
--- vdr-1.7.26/po/cs_CZ.po	2012-03-08 14:37:15.000000000 +0100
+++ vdr-1.7.27/po/cs_CZ.po	2012-03-11 11:44:43.000000000 +0100
@@ -650,7 +650,7 @@
 msgid "Button$Folder"
 msgstr "SloÅ¾ka"
 
-msgid "Button$Once"
+msgid "Button$Single"
 msgstr ""
 
 msgid "Button$Repeating"
diff -ruN vdr-1.7.26/po/da_DK.po vdr-1.7.27/po/da_DK.po
--- vdr-1.7.26/po/da_DK.po	2012-03-08 14:37:15.000000000 +0100
+++ vdr-1.7.27/po/da_DK.po	2012-03-11 11:44:43.000000000 +0100
@@ -648,7 +648,7 @@
 msgid "Button$Folder"
 msgstr ""
 
-msgid "Button$Once"
+msgid "Button$Single"
 msgstr ""
 
 msgid "Button$Repeating"
diff -ruN vdr-1.7.26/po/de_DE.po vdr-1.7.27/po/de_DE.po
--- vdr-1.7.26/po/de_DE.po	2012-03-08 14:37:52.000000000 +0100
+++ vdr-1.7.27/po/de_DE.po	2012-03-11 11:44:44.000000000 +0100
@@ -648,7 +648,7 @@
 msgid "Button$Folder"
 msgstr "Verzeichnis"
 
-msgid "Button$Once"
+msgid "Button$Single"
 msgstr "Einmalig"
 
 msgid "Button$Repeating"
diff -ruN vdr-1.7.26/po/el_GR.po vdr-1.7.27/po/el_GR.po
--- vdr-1.7.26/po/el_GR.po	2012-03-08 14:37:16.000000000 +0100
+++ vdr-1.7.27/po/el_GR.po	2012-03-11 11:44:43.000000000 +0100
@@ -648,7 +648,7 @@
 msgid "Button$Folder"
 msgstr ""
 
-msgid "Button$Once"
+msgid "Button$Single"
 msgstr ""
 
 msgid "Button$Repeating"
diff -ruN vdr-1.7.26/po/es_ES.po vdr-1.7.27/po/es_ES.po
--- vdr-1.7.26/po/es_ES.po	2012-03-08 14:37:15.000000000 +0100
+++ vdr-1.7.27/po/es_ES.po	2012-03-11 11:44:43.000000000 +0100
@@ -649,7 +649,7 @@
 msgid "Button$Folder"
 msgstr ""
 
-msgid "Button$Once"
+msgid "Button$Single"
 msgstr ""
 
 msgid "Button$Repeating"
diff -ruN vdr-1.7.26/po/et_EE.po vdr-1.7.27/po/et_EE.po
--- vdr-1.7.26/po/et_EE.po	2012-03-08 14:37:15.000000000 +0100
+++ vdr-1.7.27/po/et_EE.po	2012-03-12 11:03:28.000000000 +0100
@@ -648,14 +648,14 @@
 msgid "Button$Folder"
 msgstr "Kaust"
 
-msgid "Button$Once"
-msgstr ""
+msgid "Button$Single"
+msgstr "Ãks kord"
 
 msgid "Button$Repeating"
-msgstr ""
+msgstr "Korduv"
 
 msgid "First day"
-msgstr "Esimene pÃ¤ev"
+msgstr "1. pÃ¤ev"
 
 msgid "Select folder"
 msgstr "Kausta valik"
diff -ruN vdr-1.7.26/po/fi_FI.po vdr-1.7.27/po/fi_FI.po
--- vdr-1.7.26/po/fi_FI.po	2012-03-08 14:37:15.000000000 +0100
+++ vdr-1.7.27/po/fi_FI.po	2012-03-11 11:44:43.000000000 +0100
@@ -651,11 +651,11 @@
 msgid "Button$Folder"
 msgstr "Kansio"
 
-msgid "Button$Once"
-msgstr ""
+msgid "Button$Single"
+msgstr "YksittÃ¤inen"
 
 msgid "Button$Repeating"
-msgstr ""
+msgstr "Toistuva"
 
 msgid "First day"
 msgstr "1. pÃ¤ivÃ¤"
diff -ruN vdr-1.7.26/po/fr_FR.po vdr-1.7.27/po/fr_FR.po
--- vdr-1.7.26/po/fr_FR.po	2012-03-08 14:37:16.000000000 +0100
+++ vdr-1.7.27/po/fr_FR.po	2012-03-11 11:44:44.000000000 +0100
@@ -654,7 +654,7 @@
 msgid "Button$Folder"
 msgstr ""
 
-msgid "Button$Once"
+msgid "Button$Single"
 msgstr ""
 
 msgid "Button$Repeating"
diff -ruN vdr-1.7.26/po/hr_HR.po vdr-1.7.27/po/hr_HR.po
--- vdr-1.7.26/po/hr_HR.po	2012-03-08 14:37:16.000000000 +0100
+++ vdr-1.7.27/po/hr_HR.po	2012-03-11 11:44:44.000000000 +0100
@@ -650,7 +650,7 @@
 msgid "Button$Folder"
 msgstr ""
 
-msgid "Button$Once"
+msgid "Button$Single"
 msgstr ""
 
 msgid "Button$Repeating"
diff -ruN vdr-1.7.26/po/hu_HU.po vdr-1.7.27/po/hu_HU.po
--- vdr-1.7.26/po/hu_HU.po	2012-03-08 14:37:15.000000000 +0100
+++ vdr-1.7.27/po/hu_HU.po	2012-03-11 11:44:43.000000000 +0100
@@ -651,7 +651,7 @@
 msgid "Button$Folder"
 msgstr "Könyvtár"
 
-msgid "Button$Once"
+msgid "Button$Single"
 msgstr ""
 
 msgid "Button$Repeating"
diff -ruN vdr-1.7.26/po/it_IT.po vdr-1.7.27/po/it_IT.po
--- vdr-1.7.26/po/it_IT.po	2012-03-08 14:37:15.000000000 +0100
+++ vdr-1.7.27/po/it_IT.po	2012-03-19 09:16:10.000000000 +0100
@@ -12,7 +12,7 @@
 "Project-Id-Version: VDR 1.6.0\n"
 "Report-Msgid-Bugs-To: <vdr-bugs@tvdr.de>\n"
 "POT-Creation-Date: 2012-03-08 14:37+0100\n"
-"PO-Revision-Date: 2012-01-15 19:11+0100\n"
+"PO-Revision-Date: 2012-03-19 01:08+0100\n"
 "Last-Translator: Diego Pierotto <vdr-italian@tiscali.it>\n"
 "Language-Team: Italian <vdr@linuxtv.org>\n"
 "Language: it\n"
@@ -655,11 +655,11 @@
 msgid "Button$Folder"
 msgstr "Cartella"
 
-msgid "Button$Once"
-msgstr ""
+msgid "Button$Single"
+msgstr "Una volta"
 
 msgid "Button$Repeating"
-msgstr ""
+msgstr "Repliche"
 
 msgid "First day"
 msgstr "1Â° giorno"
@@ -758,7 +758,7 @@
 msgstr "Eliminare la registrazione?"
 
 msgid "Recording is being edited - really delete?"
-msgstr ""
+msgstr "La registrazione Ã¨ stata modificata - sicuro di eliminare?"
 
 msgid "Error while deleting recording!"
 msgstr "Errore eliminazione registrazione!"
diff -ruN vdr-1.7.26/po/lt_LT.po vdr-1.7.27/po/lt_LT.po
--- vdr-1.7.26/po/lt_LT.po	2012-03-08 14:37:16.000000000 +0100
+++ vdr-1.7.27/po/lt_LT.po	2012-03-11 11:44:43.000000000 +0100
@@ -648,7 +648,7 @@
 msgid "Button$Folder"
 msgstr "Katalogas"
 
-msgid "Button$Once"
+msgid "Button$Single"
 msgstr ""
 
 msgid "Button$Repeating"
diff -ruN vdr-1.7.26/po/mk_MK.po vdr-1.7.27/po/mk_MK.po
--- vdr-1.7.26/po/mk_MK.po	2012-03-08 14:37:16.000000000 +0100
+++ vdr-1.7.27/po/mk_MK.po	2012-03-11 11:44:44.000000000 +0100
@@ -649,7 +649,7 @@
 msgid "Button$Folder"
 msgstr "ÐÐ¸ÑÐµÐºÑÐ¾ÑÐ¸ÑÐ¼"
 
-msgid "Button$Once"
+msgid "Button$Single"
 msgstr ""
 
 msgid "Button$Repeating"
diff -ruN vdr-1.7.26/po/nl_NL.po vdr-1.7.27/po/nl_NL.po
--- vdr-1.7.26/po/nl_NL.po	2012-03-08 14:37:15.000000000 +0100
+++ vdr-1.7.27/po/nl_NL.po	2012-03-11 11:44:43.000000000 +0100
@@ -652,7 +652,7 @@
 msgid "Button$Folder"
 msgstr ""
 
-msgid "Button$Once"
+msgid "Button$Single"
 msgstr ""
 
 msgid "Button$Repeating"
diff -ruN vdr-1.7.26/po/nn_NO.po vdr-1.7.27/po/nn_NO.po
--- vdr-1.7.26/po/nn_NO.po	2012-03-08 14:37:16.000000000 +0100
+++ vdr-1.7.27/po/nn_NO.po	2012-03-11 11:44:44.000000000 +0100
@@ -649,7 +649,7 @@
 msgid "Button$Folder"
 msgstr ""
 
-msgid "Button$Once"
+msgid "Button$Single"
 msgstr ""
 
 msgid "Button$Repeating"
diff -ruN vdr-1.7.26/po/pl_PL.po vdr-1.7.27/po/pl_PL.po
--- vdr-1.7.26/po/pl_PL.po	2012-03-08 14:37:14.000000000 +0100
+++ vdr-1.7.27/po/pl_PL.po	2012-03-11 11:44:43.000000000 +0100
@@ -649,7 +649,7 @@
 msgid "Button$Folder"
 msgstr ""
 
-msgid "Button$Once"
+msgid "Button$Single"
 msgstr ""
 
 msgid "Button$Repeating"
diff -ruN vdr-1.7.26/po/pt_PT.po vdr-1.7.27/po/pt_PT.po
--- vdr-1.7.26/po/pt_PT.po	2012-03-08 14:37:14.000000000 +0100
+++ vdr-1.7.27/po/pt_PT.po	2012-03-11 11:44:42.000000000 +0100
@@ -649,7 +649,7 @@
 msgid "Button$Folder"
 msgstr "Pasta"
 
-msgid "Button$Once"
+msgid "Button$Single"
 msgstr ""
 
 msgid "Button$Repeating"
diff -ruN vdr-1.7.26/po/ro_RO.po vdr-1.7.27/po/ro_RO.po
--- vdr-1.7.26/po/ro_RO.po	2012-03-08 14:37:15.000000000 +0100
+++ vdr-1.7.27/po/ro_RO.po	2012-03-11 11:44:43.000000000 +0100
@@ -651,7 +651,7 @@
 msgid "Button$Folder"
 msgstr "Director"
 
-msgid "Button$Once"
+msgid "Button$Single"
 msgstr ""
 
 msgid "Button$Repeating"
diff -ruN vdr-1.7.26/po/ru_RU.po vdr-1.7.27/po/ru_RU.po
--- vdr-1.7.26/po/ru_RU.po	2012-03-08 14:37:16.000000000 +0100
+++ vdr-1.7.27/po/ru_RU.po	2012-03-11 11:44:44.000000000 +0100
@@ -649,7 +649,7 @@
 msgid "Button$Folder"
 msgstr ""
 
-msgid "Button$Once"
+msgid "Button$Single"
 msgstr ""
 
 msgid "Button$Repeating"
diff -ruN vdr-1.7.26/po/sk_SK.po vdr-1.7.27/po/sk_SK.po
--- vdr-1.7.26/po/sk_SK.po	2012-03-08 14:37:16.000000000 +0100
+++ vdr-1.7.27/po/sk_SK.po	2012-03-11 11:44:44.000000000 +0100
@@ -648,7 +648,7 @@
 msgid "Button$Folder"
 msgstr "Zlo¾ka"
 
-msgid "Button$Once"
+msgid "Button$Single"
 msgstr ""
 
 msgid "Button$Repeating"
diff -ruN vdr-1.7.26/po/sl_SI.po vdr-1.7.27/po/sl_SI.po
--- vdr-1.7.26/po/sl_SI.po	2012-03-08 14:37:16.000000000 +0100
+++ vdr-1.7.27/po/sl_SI.po	2012-03-11 11:44:44.000000000 +0100
@@ -649,7 +649,7 @@
 msgid "Button$Folder"
 msgstr ""
 
-msgid "Button$Once"
+msgid "Button$Single"
 msgstr ""
 
 msgid "Button$Repeating"
diff -ruN vdr-1.7.26/po/sr_SR.po vdr-1.7.27/po/sr_SR.po
--- vdr-1.7.26/po/sr_SR.po	2012-03-08 14:37:16.000000000 +0100
+++ vdr-1.7.27/po/sr_SR.po	2012-03-11 11:44:44.000000000 +0100
@@ -654,7 +654,7 @@
 msgid "Button$Folder"
 msgstr "Taster$Direktorij"
 
-msgid "Button$Once"
+msgid "Button$Single"
 msgstr ""
 
 msgid "Button$Repeating"
diff -ruN vdr-1.7.26/po/sv_SE.po vdr-1.7.27/po/sv_SE.po
--- vdr-1.7.26/po/sv_SE.po	2012-03-08 14:37:16.000000000 +0100
+++ vdr-1.7.27/po/sv_SE.po	2012-03-11 11:44:44.000000000 +0100
@@ -651,7 +651,7 @@
 msgid "Button$Folder"
 msgstr ""
 
-msgid "Button$Once"
+msgid "Button$Single"
 msgstr ""
 
 msgid "Button$Repeating"
diff -ruN vdr-1.7.26/po/tr_TR.po vdr-1.7.27/po/tr_TR.po
--- vdr-1.7.26/po/tr_TR.po	2012-03-08 14:37:15.000000000 +0100
+++ vdr-1.7.27/po/tr_TR.po	2012-03-11 11:44:43.000000000 +0100
@@ -648,7 +648,7 @@
 msgid "Button$Folder"
 msgstr ""
 
-msgid "Button$Once"
+msgid "Button$Single"
 msgstr ""
 
 msgid "Button$Repeating"
diff -ruN vdr-1.7.26/po/uk_UA.po vdr-1.7.27/po/uk_UA.po
--- vdr-1.7.26/po/uk_UA.po	2012-03-08 14:37:15.000000000 +0100
+++ vdr-1.7.27/po/uk_UA.po	2012-03-11 11:44:43.000000000 +0100
@@ -648,7 +648,7 @@
 msgid "Button$Folder"
 msgstr "ÐÐ°ÑÐ°Ð»Ð¾Ð³"
 
-msgid "Button$Once"
+msgid "Button$Single"
 msgstr ""
 
 msgid "Button$Repeating"
diff -ruN vdr-1.7.26/po/zh_CN.po vdr-1.7.27/po/zh_CN.po
--- vdr-1.7.26/po/zh_CN.po	2012-03-08 14:37:15.000000000 +0100
+++ vdr-1.7.27/po/zh_CN.po	2012-03-11 11:44:43.000000000 +0100
@@ -651,7 +651,7 @@
 msgid "Button$Folder"
 msgstr ""
 
-msgid "Button$Once"
+msgid "Button$Single"
 msgstr ""
 
 msgid "Button$Repeating"
diff -ruN vdr-1.7.26/receiver.h vdr-1.7.27/receiver.h
--- vdr-1.7.26/receiver.h	2012-03-01 10:50:24.000000000 +0100
+++ vdr-1.7.27/receiver.h	2012-03-11 16:25:40.000000000 +0100
@@ -4,7 +4,7 @@
  * See the main source file 'vdr.c' for copyright information and
  * how to reach the author.
  *
- * $Id: receiver.h 2.5 2012/03/01 09:50:24 kls Exp $
+ * $Id: receiver.h 2.6 2012/03/11 15:25:40 kls Exp $
  */
 
 #ifndef __RECEIVER_H
@@ -14,7 +14,7 @@
 
 #define MAXRECEIVEPIDS  64 // the maximum number of PIDs per receiver
 
-#define LEGACY_CRECEIVER // Code enclosed with this macro is deprecated and may be removed in a future version
+//#define LEGACY_CRECEIVER // Code enclosed with this macro is deprecated and may be removed in a future version
 
 class cReceiver {
   friend class cDevice;
diff -ruN vdr-1.7.26/recording.c vdr-1.7.27/recording.c
--- vdr-1.7.26/recording.c	2012-02-26 14:58:26.000000000 +0100
+++ vdr-1.7.27/recording.c	2012-03-13 14:17:57.000000000 +0100
@@ -4,7 +4,7 @@
  * See the main source file 'vdr.c' for copyright information and
  * how to reach the author.
  *
- * $Id: recording.c 2.51 2012/02/26 13:58:26 kls Exp $
+ * $Id: recording.c 2.53 2012/03/13 13:17:57 kls Exp $
  */
 
 #include "recording.h"
@@ -1063,6 +1063,17 @@
   return -1;
 }
 
+int cRecording::FileSizeMB(void) const
+{
+  if (fileSizeMB < 0) {
+     int fs = DirSizeMB(FileName());
+     if (time(NULL) - LastModifiedTime(FileName()) < MININDEXAGE)
+        return fs; // check again later for ongoing recordings
+     fileSizeMB = fs;
+     }
+  return fileSizeMB;
+}
+
 // --- cRecordings -----------------------------------------------------------
 
 cRecordings Recordings;
@@ -1127,14 +1138,13 @@
                  cRecording *r = new cRecording(buffer);
                  if (r->Name()) {
                     r->NumFrames(); // initializes the numFrames member
+                    r->FileSizeMB(); // initializes the fileSizeMB member
+                    if (deleted)
+                       r->deleted = time(NULL);
                     Lock();
                     Add(r);
                     ChangeState();
                     Unlock();
-                    if (deleted) {
-                       r->fileSizeMB = DirSizeMB(buffer);
-                       r->deleted = time(NULL);
-                       }
                     }
                  else
                     delete r;
@@ -1216,7 +1226,6 @@
      if (ext) {
         strncpy(ext, DELEXT, strlen(ext));
         if (access(recording->FileName(), F_OK) == 0) {
-           recording->fileSizeMB = DirSizeMB(recording->FileName());
            recording->deleted = time(NULL);
            DeletedRecordings.Add(recording);
            recording = NULL; // to prevent it from being deleted below
@@ -1241,12 +1250,33 @@
   int size = 0;
   LOCK_THREAD;
   for (cRecording *recording = First(); recording; recording = Next(recording)) {
-      if (recording->fileSizeMB > 0 && IsOnVideoDirectoryFileSystem(recording->FileName()))
-         size += recording->fileSizeMB;
+      int FileSizeMB = recording->FileSizeMB();
+      if (FileSizeMB > 0 && IsOnVideoDirectoryFileSystem(recording->FileName()))
+         size += FileSizeMB;
       }
   return size;
 }
 
+double cRecordings::MBperMinute(void)
+{
+  int size = 0;
+  int length = 0;
+  LOCK_THREAD;
+  for (cRecording *recording = First(); recording; recording = Next(recording)) {
+      if (IsOnVideoDirectoryFileSystem(recording->FileName())) {
+         int FileSizeMB = recording->FileSizeMB();
+         if (FileSizeMB > 0) {
+            int LengthInSeconds = recording->LengthInSeconds();
+            if (LengthInSeconds > 0) {
+               size += FileSizeMB;
+               length += LengthInSeconds;
+               }
+            }
+         }
+      }
+  return (size && length) ? double(size) * 60 / length : -1;
+}
+
 void cRecordings::ResetResume(const char *ResumeFileName)
 {
   LOCK_THREAD;
@@ -1526,9 +1556,6 @@
 
 #define INDEXFILESUFFIX     "/index"
 
-// The number of frames to stay off the end in case of time shift:
-#define INDEXSAFETYLIMIT 150 // frames
-
 // The maximum time to wait before giving up while catching up on an index file:
 #define MAXINDEXCATCHUP   8 // seconds
 
@@ -1728,7 +1755,7 @@
             }
          else
             LOG_ERROR_STR(*fileName);
-         if (Index < last - (i ? 2 * INDEXSAFETYLIMIT : 0) || Index > 10 * INDEXSAFETYLIMIT) // keep off the end in case of "Pause live video"
+         if (Index < last)
             break;
          cCondWait::SleepMs(1000);
          }
@@ -1775,13 +1802,13 @@
   return false;
 }
 
-int cIndexFile::GetNextIFrame(int Index, bool Forward, uint16_t *FileNumber, off_t *FileOffset, int *Length, bool StayOffEnd)
+int cIndexFile::GetNextIFrame(int Index, bool Forward, uint16_t *FileNumber, off_t *FileOffset, int *Length)
 {
   if (CatchUp()) {
      int d = Forward ? 1 : -1;
      for (;;) {
          Index += d;
-         if (Index >= 0 && Index < last - ((Forward && StayOffEnd) ? INDEXSAFETYLIMIT : 0)) {
+         if (Index >= 0 && Index < last) {
             if (index[Index].independent) {
                uint16_t fn;
                if (!FileNumber)
diff -ruN vdr-1.7.26/recording.h vdr-1.7.27/recording.h
--- vdr-1.7.26/recording.h	2012-02-19 11:44:53.000000000 +0100
+++ vdr-1.7.27/recording.h	2012-03-13 13:41:05.000000000 +0100
@@ -4,7 +4,7 @@
  * See the main source file 'vdr.c' for copyright information and
  * how to reach the author.
  *
- * $Id: recording.h 2.27 2012/02/19 10:44:53 kls Exp $
+ * $Id: recording.h 2.30 2012/03/13 12:41:05 kls Exp $
  */
 
 #ifndef __RECORDING_H
@@ -22,7 +22,7 @@
 #define TIMERMACRO_TITLE    "TITLE"
 #define TIMERMACRO_EPISODE  "EPISODE"
 
-#define __RECORDING_H_DEPRECATED_DIRECT_MEMBER_ACCESS // Code enclosed with this macro is deprecated and may be removed in a future version
+//#define __RECORDING_H_DEPRECATED_DIRECT_MEMBER_ACCESS // Code enclosed with this macro is deprecated and may be removed in a future version
 
 extern bool VfatFileSystem;
 extern int InstanceId;
@@ -129,6 +129,9 @@
        ///< If the number of frames is unknown, -1 will be returned.
   int LengthInSeconds(void) const;
        ///< Returns the length (in seconds) of this recording, or -1 in case of error.
+  int FileSizeMB(void) const;
+       ///< Returns the total file size of this recording (in MB), or -1 if the file
+       ///< size is unknown.
   bool IsNew(void) const { return GetResume() <= 0; }
   bool IsEdited(void) const;
   bool IsPesRecording(void) const { return isPesRecording; }
@@ -190,7 +193,10 @@
   void AddByName(const char *FileName, bool TriggerUpdate = true);
   void DelByName(const char *FileName);
   void UpdateByName(const char *FileName);
-  int TotalFileSizeMB(void); ///< Only for deleted recordings!
+  int TotalFileSizeMB(void);
+  double MBperMinute(void);
+       ///< Returns the average data rate (in MB/min) of all recordings, or -1 if
+       ///< this value is unknown.
   };
 
 extern cRecordings Recordings;
@@ -284,7 +290,7 @@
   bool Ok(void) { return index != NULL; }
   bool Write(bool Independent, uint16_t FileNumber, off_t FileOffset);
   bool Get(int Index, uint16_t *FileNumber, off_t *FileOffset, bool *Independent = NULL, int *Length = NULL);
-  int GetNextIFrame(int Index, bool Forward, uint16_t *FileNumber = NULL, off_t *FileOffset = NULL, int *Length = NULL, bool StayOffEnd = false);
+  int GetNextIFrame(int Index, bool Forward, uint16_t *FileNumber = NULL, off_t *FileOffset = NULL, int *Length = NULL);
   int Get(uint16_t FileNumber, off_t FileOffset);
   int Last(void) { CatchUp(); return last; }
   int GetResume(void) { return resumeFile.Read(); }
diff -ruN vdr-1.7.26/skins.c vdr-1.7.27/skins.c
--- vdr-1.7.26/skins.c	2012-02-20 12:47:15.000000000 +0100
+++ vdr-1.7.27/skins.c	2012-03-11 15:36:11.000000000 +0100
@@ -4,7 +4,7 @@
  * See the main source file 'vdr.c' for copyright information and
  * how to reach the author.
  *
- * $Id: skins.c 2.4 2012/02/20 11:47:15 kls Exp $
+ * $Id: skins.c 2.5 2012/03/11 14:36:11 kls Exp $
  */
 
 #include "skins.h"
@@ -78,9 +78,8 @@
   tabs[3] = Tab3 ? tabs[2] + Tab3 : 0;
   tabs[4] = Tab4 ? tabs[3] + Tab4 : 0;
   tabs[5] = Tab5 ? tabs[4] + Tab5 : 0;
-  int AvgCharWidth = Setup.FontOsdSize * 4 / 6; // just an estimate
   for (int i = 1; i < MaxTabs; i++)
-      tabs[i] *= AvgCharWidth;
+      tabs[i] *= AvgCharWidth();
 }
 
 void cSkinDisplayMenu::Scroll(bool Up, bool Page)
diff -ruN vdr-1.7.26/skins.h vdr-1.7.27/skins.h
--- vdr-1.7.26/skins.h	2011-12-04 14:38:17.000000000 +0100
+++ vdr-1.7.27/skins.h	2012-03-11 15:38:23.000000000 +0100
@@ -4,7 +4,7 @@
  * See the main source file 'vdr.c' for copyright information and
  * how to reach the author.
  *
- * $Id: skins.h 2.1 2011/12/04 13:38:17 kls Exp $
+ * $Id: skins.h 2.2 2012/03/11 14:38:23 kls Exp $
  */
 
 #ifndef __SKINS_H
@@ -28,6 +28,8 @@
 public:
   cSkinDisplay(void);
   virtual ~cSkinDisplay();
+  static int AvgCharWidth(void) { return Setup.FontOsdSize * 4 / 6; }
+       ///< Returns the average width of a character in pixel (just a raw estimate).
   int EditableWidth(void) { return editableWidth; }
   void SetEditableWidth(int Width) { editableWidth = Width; }
        ///< If an item is set through a call to cSkinDisplayMenu::SetItem(), this
diff -ruN vdr-1.7.26/skinsttng.c vdr-1.7.27/skinsttng.c
--- vdr-1.7.26/skinsttng.c	2012-03-05 13:01:26.000000000 +0100
+++ vdr-1.7.27/skinsttng.c	2012-03-11 15:06:05.000000000 +0100
@@ -4,10 +4,10 @@
  * See the main source file 'vdr.c' for copyright information and
  * how to reach the author.
  *
- * $Id: skinsttng.c 2.13 2012/03/05 12:01:26 kls Exp $
+ * $Id: skinsttng.c 2.14 2012/03/11 14:06:05 kls Exp $
  */
 
-// Star Trek: The Next Generation® is a registered trademark of Paramount Pictures
+// "Star Trek: The Next Generation"(R) is a registered trademark of Paramount Pictures
 // registered in the United States Patent and Trademark Office.
 // No infringement intended.
 
diff -ruN vdr-1.7.26/vdr.c vdr-1.7.27/vdr.c
--- vdr-1.7.26/vdr.c	2012-03-09 10:55:15.000000000 +0100
+++ vdr-1.7.27/vdr.c	2012-03-14 10:09:19.000000000 +0100
@@ -22,7 +22,7 @@
  *
  * The project's page is at http://www.tvdr.de
  *
- * $Id: vdr.c 2.34 2012/03/09 09:55:15 kls Exp $
+ * $Id: vdr.c 2.35 2012/03/14 09:09:19 kls Exp $
  */
 
 #include <getopt.h>
@@ -173,6 +173,7 @@
   // Initiate locale:
 
   setlocale(LC_ALL, "");
+  setlocale(LC_NUMERIC, "C"); // makes sure any floating point numbers written use a decimal point
 
   // Command line options:
 
@@ -550,7 +551,6 @@
      isyslog("codeset is '%s' - %s", CodeSet, known ? "known" : "unknown");
      cCharSetConv::SetSystemCharacterTable(CodeSet);
      }
-  setlocale(LC_NUMERIC, "C"); // makes sure any floating point numbers written use a decimal point
 
   // Initialize internationalization:
 
